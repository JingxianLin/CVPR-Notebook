
Part 2: Using the xfDNN Quantizer to Recalibrate Models
=======================================================

Introduction
------------

In this part of the lab, we will look at quantizing 32-bit floating
point models to Int16 or Int8 inpreparation for deployment. Deploying
Int16/8 models dramatically improves inference deployment and lowers
latency. While floating point precision is useful in model training, it
is more energy efficient as well as lower latency to deploy models in
lower precison.

The xfDNN Quantizer performs a technique of quantization known as
recalibration. This technique does not require full retraining of the
model, and can be accomplished in a matter of seconds, as you will see
below. It also allows you to maintain the accuracy of the high precision
model.

Quantization of the model does not alter the orginal high precision
model, rather, it calculates the dynamic range of the model and produces
scaling parameters recorded in a json file, which will be used by the
xDNN overlay during execution of the network/model. Quantization of the
model is an offline process that only needs to be performed once per
model. The quantizer produces an optimal target quantization from a
given network (prototxt and caffemodel) and calibration set (unlabeled
input images) without requiring hours of retraining or a labeled
dataset.

In this lab, we will look at quantizing an optimized model generated
from Part 1, defined in Caffe prototxt and caffemodel, to Int16 and
Int8. Depending on your earlier notebook this will be either a
GoogLeNet-v1 or Resnet-50 model.

Just like in Part 1, first we will run through an example, then you will
get a chance to try the quantizer yourself.

1. Import required packages
~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. code:: ipython2

    import os,sys
    from __future__ import print_function
    
    # Bring in Xilinx ML-Suite Compiler
    from xfdnn.tools.quantize.quantize import CaffeFrontend as xfdnnQuantizer

1. Create Quantizer Instance and run it
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

To simplify handling of arguments, a config dictionary is used. Take a
look at the dictionary below.

| The arguments that need to be passed are: - ``outmodel`` - Filename
  generated by the compiler for the optimized prototxt and caffemodel. -
  ``quantizecfg`` - Output JSON filename of quantization scaling
  parameters. - ``bitwidths`` - Desired precision from quantizer. This
  is to set the precision for [image data, weight bitwidth, conv
  output]. All three values need to be set to the same setting. The
  valid options are ``16`` for Int16 and ``8`` for Int8.
| - ``in_shape`` - Sets the desired input image size of the first layer.
  Images will be resized to these demensions and must match the network
  data/placeholder layer. - ``transpose`` - Images start as H,W,C
  (H=0,W=1,C=2) transpose swaps to C,H,W (2,0,1) for typical networks. -
  ``channel_swap`` - Depending on network training and image read, can
  swap from RGB (R=0,G=1,B=2) to BGR (2,1,0). - ``raw_scale`` -
  Depending on network training, scale pixel values before mean
  subtraction. - ``img_mean`` - Depending on network training, subtract
  image mean if available. - ``input_scale`` - Depending on network
  training, scale after subtracting mean. - ``calibration_size`` -
  Number of images the quantizer will use to calculate the dynamic
  range. - ``calibration_directory`` - Location of dir of images used
  for the calibration process.

Below is an example with all the parameters filled in. ``channel_swap``
``raw_scale`` ``img_mean`` ``input_scale`` are expert parameters that
should be left in the default positions, indicated below.

.. code:: ipython2

    # Use a config dictionary to pass parameters to the compiler
    config = {}
    
    config["caffemodel"] = "work/optimized_model" # String for naming intermediate prototxt, caffemodel
    
    # Quantizer Arguments
    #config["outmodel"] = Defined in Step 1 # String for naming intermediate prototxt, caffemodel
    config["quantizecfg"] = "work/quantization_params.json" # Quantizer will generate quantization params
    config["bitwidths"] = [16,16,16] # Supported quantization precision
    config["in_shape"] = [3,224,224] # Images will be resized to this shape -> Needs to match prototxt
    config["transpose"] = [2,0,1] # (H,W,C)->(C,H,W) transpose argument to quantizer
    config["channel_swap"] = [2,1,0] # (R,G,B)->(B,G,R) Channel Swap argument to quantizer
    config["raw_scale"] = 255.0
    config["img_mean"] = [104.007, 116.669, 122.679] # Mean of the training set (From Imagenet)
    config["input_scale"] = 1.0
    config["calibration_size"] = 8 # Number of calibration images quantizer will use
    config["calibration_directory"] = "../xfdnn/tools/quantize/calibration_directory" # Directory of images
    
    quantizer = xfdnnQuantizer(
        deploy_model=config["caffemodel"]+".prototxt",        # Model filename: input file
        weights=config["caffemodel"]+".caffemodel",           # Floating Point weights
        output_json=config["quantizecfg"],                    # Quantization JSON output filename
        bitwidths=config["bitwidths"],                        # Fixed Point precision: 8,8,8 or 16,16,16
        dims=config["in_shape"],                              # Image dimensions [C,H,W]
        transpose=config["transpose"],                        # Transpose argument to caffe transformer
        channel_swap=config["channel_swap"],                  # Channel swap argument to caffe transfomer
        raw_scale=config["raw_scale"],                        # Raw scale argument to caffe transformer
        mean_value=config["img_mean"],                        # Image mean per channel to caffe transformer
        input_scale=config["input_scale"],                    # Input scale argument to caffe transformer
        calibration_size=config["calibration_size"],          # Number of calibration images to use
        calibration_directory=config["calibration_directory"] # Directory containing calbration images
    )
    
    # Invoke quantizer
    try:
        quantizer.quantize()
    
        import json
        data = json.loads(open(config["quantizecfg"]).read())
        print("**********\nSuccessfully produced quantization JSON file for %d layers.\n"%len(data['network']))
    except Exception as e:
        print("Failed to quantize:",e)


.. parsed-literal::

    Mean : [104.007 116.669 122.679]
    Adding ../xfdnn/tools/quantize/calibration_directory/16247716843_b419e8b111_z.jpg to calibration batch.


.. parsed-literal::

    /home/centos/anaconda2/envs/ml-suite/lib/python2.7/site-packages/skimage/io/_io.py:49: UserWarning: `as_grey` has been deprecated in favor of `as_gray`
      warn('`as_grey` has been deprecated in favor of `as_gray`')
    /home/centos/anaconda2/envs/ml-suite/lib/python2.7/site-packages/skimage/transform/_warps.py:105: UserWarning: The default mode, 'constant', will be changed to 'reflect' in skimage 0.15.
      warn("The default mode, 'constant', will be changed to 'reflect' in "
    /home/centos/anaconda2/envs/ml-suite/lib/python2.7/site-packages/skimage/transform/_warps.py:110: UserWarning: Anti-aliasing will be enabled by default in skimage 0.15 to avoid aliasing artifacts when down-sampling images.
      warn("Anti-aliasing will be enabled by default in skimage 0.15 to "


.. parsed-literal::

    Adding ../xfdnn/tools/quantize/calibration_directory/3272651417_27976a64b3_z.jpg to calibration batch.
    Adding ../xfdnn/tools/quantize/calibration_directory/36085792773_b9a3d115a3_z.jpg to calibration batch.
    Adding ../xfdnn/tools/quantize/calibration_directory/4788821373_441cd29c9f_z.jpg to calibration batch.
    Adding ../xfdnn/tools/quantize/calibration_directory/5904386289_924b24d75d_z.jpg to calibration batch.
    Adding ../xfdnn/tools/quantize/calibration_directory/7291910830_86a8ebb15d_z.jpg to calibration batch.
    Adding ../xfdnn/tools/quantize/calibration_directory/7647574936_ffebfa2bea_z.jpg to calibration batch.
    Adding ../xfdnn/tools/quantize/calibration_directory/78947826_fc79a94bf2_z.jpg to calibration batch.
    --------------------------------------------------------------------------------
    Processing layer 0 of 139
    Layer Name:data Type:Input
    Inputs: [], Outputs: ['data']
    Quantizing layer output...
    n:  32768 , len(bin_edges):  1099
    Mean : th_layer_out:  150.9929962158203 , sf_layer_out:  0.00460808118582172
    bw_layer_out:  16
    th_layer_out:  150.9929962158203
    --------------------------------------------------------------------------------
    Processing layer 1 of 139
    Layer Name:conv1 Type:Convolution
    Inputs: ['data'], Outputs: ['conv1']
    Quantizing conv input layer ... conv1
    Threshold in shape= ()
    Quantizing conv weights for layer conv1...
    Threshold params shape= (64,)
    n:  32768 , len(bin_edges):  2536
    Mean : th_layer_out:  31.334564208984375 , sf_layer_out:  0.0009562841947381321
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  2536
    Mean : th_layer_out:  31.334564208984375 , sf_layer_out:  0.0009562841947381321
    bw_layer_in:  16
    th_layer_in:  150.9929962158203
    bw_layer_out:  16
    th_layer_out:  31.334564208984375
    --------------------------------------------------------------------------------
    Processing layer 2 of 139
    Layer Name:conv1_relu Type:ReLU
    Inputs: ['conv1'], Outputs: ['conv1']
    n:  32768 , len(bin_edges):  2536
    Mean : th_layer_out:  31.334564208984375 , sf_layer_out:  0.0009562841947381321
    bw_layer_out:  16
    th_layer_out:  31.334564208984375
    --------------------------------------------------------------------------------
    Processing layer 3 of 139
    Layer Name:pool1 Type:Pooling
    Inputs: ['conv1'], Outputs: ['pool1']
    bw_layer_in:  16
    th_layer_in:  31.334564208984375
    bw_layer_out:  16
    th_layer_out:  31.334564208984375
    --------------------------------------------------------------------------------
    Processing layer 4 of 139
    Layer Name:pool1_pool1_0_split Type:Split
    Inputs: ['pool1'], Outputs: ['pool1_pool1_0_split_0', 'pool1_pool1_0_split_1']
    bw_layer_in:  16
    th_layer_in:  31.334564208984375
    bw_layer_out:  16
    th_layer_out:  31.334564208984375
    --------------------------------------------------------------------------------
    Processing layer 5 of 139
    Layer Name:res2a_branch1 Type:Convolution
    Inputs: ['pool1_pool1_0_split_0'], Outputs: ['res2a_branch1']
    Quantizing conv input layer ... res2a_branch1
    Threshold in shape= ()
    Quantizing conv weights for layer res2a_branch1...
    Threshold params shape= (256,)
    n:  32768 , len(bin_edges):  2536
    Mean : th_layer_out:  27.25199317932129 , sf_layer_out:  0.0008316902120829277
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  2536
    Mean : th_layer_out:  27.25199317932129 , sf_layer_out:  0.0008316902120829277
    bw_layer_in:  16
    th_layer_in:  31.334564208984375
    bw_layer_out:  16
    th_layer_out:  27.25199317932129
    --------------------------------------------------------------------------------
    Processing layer 6 of 139
    Layer Name:res2a_branch2a Type:Convolution
    Inputs: ['pool1_pool1_0_split_1'], Outputs: ['res2a_branch2a']
    Quantizing conv input layer ... res2a_branch2a
    Threshold in shape= ()
    Quantizing conv weights for layer res2a_branch2a...
    Threshold params shape= (64,)
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  24.7375431060791 , sf_layer_out:  0.000754952943695764
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  24.7375431060791 , sf_layer_out:  0.000754952943695764
    bw_layer_in:  16
    th_layer_in:  31.334564208984375
    bw_layer_out:  16
    th_layer_out:  24.7375431060791
    --------------------------------------------------------------------------------
    Processing layer 7 of 139
    Layer Name:res2a_branch2a_relu Type:ReLU
    Inputs: ['res2a_branch2a'], Outputs: ['res2a_branch2a']
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  13.31474781036377 , sf_layer_out:  0.0004063462572210996
    bw_layer_out:  16
    th_layer_out:  13.31474781036377
    --------------------------------------------------------------------------------
    Processing layer 8 of 139
    Layer Name:res2a_branch2b Type:Convolution
    Inputs: ['res2a_branch2a'], Outputs: ['res2a_branch2b']
    Quantizing conv input layer ... res2a_branch2b
    Threshold in shape= ()
    Quantizing conv weights for layer res2a_branch2b...
    Threshold params shape= (64,)
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  12.234633445739746 , sf_layer_out:  0.0003733827767491606
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  12.234633445739746 , sf_layer_out:  0.0003733827767491606
    bw_layer_in:  16
    th_layer_in:  13.31474781036377
    bw_layer_out:  16
    th_layer_out:  12.234633445739746
    --------------------------------------------------------------------------------
    Processing layer 9 of 139
    Layer Name:res2a_branch2b_relu Type:ReLU
    Inputs: ['res2a_branch2b'], Outputs: ['res2a_branch2b']
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  12.234633445739746 , sf_layer_out:  0.0003733827767491606
    bw_layer_out:  16
    th_layer_out:  12.234633445739746
    --------------------------------------------------------------------------------
    Processing layer 10 of 139
    Layer Name:res2a_branch2c Type:Convolution
    Inputs: ['res2a_branch2b'], Outputs: ['res2a_branch2c']
    Quantizing conv input layer ... res2a_branch2c
    Threshold in shape= ()
    Quantizing conv weights for layer res2a_branch2c...
    Threshold params shape= (256,)
    n:  32768 , len(bin_edges):  2536
    Mean : th_layer_out:  11.765929222106934 , sf_layer_out:  0.00035907862245878274
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  2536
    Mean : th_layer_out:  11.765929222106934 , sf_layer_out:  0.00035907862245878274
    bw_layer_in:  16
    th_layer_in:  12.234633445739746
    bw_layer_out:  16
    th_layer_out:  11.765929222106934
    --------------------------------------------------------------------------------
    Processing layer 11 of 139
    Layer Name:res2a Type:Eltwise
    Inputs: ['res2a_branch1', 'res2a_branch2c'], Outputs: ['res2a']
    bw_layer_in:  16
    th_layer_in:  27.25199317932129
    bw_layer_out:  16
    th_layer_out:  27.25199317932129
    --------------------------------------------------------------------------------
    Processing layer 12 of 139
    Layer Name:res2a_relu Type:ReLU
    Inputs: ['res2a'], Outputs: ['res2a']
    n:  32768 , len(bin_edges):  2536
    Mean : th_layer_out:  16.74026107788086 , sf_layer_out:  0.000510887816335974
    bw_layer_out:  16
    th_layer_out:  16.74026107788086
    --------------------------------------------------------------------------------
    Processing layer 13 of 139
    Layer Name:res2a_res2a_relu_0_split Type:Split
    Inputs: ['res2a'], Outputs: ['res2a_res2a_relu_0_split_0', 'res2a_res2a_relu_0_split_1']
    bw_layer_in:  16
    th_layer_in:  16.74026107788086
    bw_layer_out:  16
    th_layer_out:  16.74026107788086
    --------------------------------------------------------------------------------
    Processing layer 14 of 139
    Layer Name:res2b_branch2a Type:Convolution
    Inputs: ['res2a_res2a_relu_0_split_0'], Outputs: ['res2b_branch2a']
    Quantizing conv input layer ... res2b_branch2a
    Threshold in shape= ()
    Quantizing conv weights for layer res2b_branch2a...
    Threshold params shape= (64,)
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  12.134781837463379 , sf_layer_out:  0.00037033545449578477
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  12.134781837463379 , sf_layer_out:  0.00037033545449578477
    bw_layer_in:  16
    th_layer_in:  16.74026107788086
    bw_layer_out:  16
    th_layer_out:  12.134781837463379
    --------------------------------------------------------------------------------
    Processing layer 15 of 139
    Layer Name:res2b_branch2a_relu Type:ReLU
    Inputs: ['res2b_branch2a'], Outputs: ['res2b_branch2a']
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  10.524314880371094 , sf_layer_out:  0.00032118640340498346
    bw_layer_out:  16
    th_layer_out:  10.524314880371094
    --------------------------------------------------------------------------------
    Processing layer 16 of 139
    Layer Name:res2b_branch2b Type:Convolution
    Inputs: ['res2b_branch2a'], Outputs: ['res2b_branch2b']
    Quantizing conv input layer ... res2b_branch2b
    Threshold in shape= ()
    Quantizing conv weights for layer res2b_branch2b...
    Threshold params shape= (64,)
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  12.544038772583008 , sf_layer_out:  0.00038282536614835073
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  12.544038772583008 , sf_layer_out:  0.00038282536614835073
    bw_layer_in:  16
    th_layer_in:  10.524314880371094
    bw_layer_out:  16
    th_layer_out:  12.544038772583008
    --------------------------------------------------------------------------------
    Processing layer 17 of 139
    Layer Name:res2b_branch2b_relu Type:ReLU
    Inputs: ['res2b_branch2b'], Outputs: ['res2b_branch2b']
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  9.34158992767334 , sf_layer_out:  0.00028509140072857875
    bw_layer_out:  16
    th_layer_out:  9.34158992767334
    --------------------------------------------------------------------------------
    Processing layer 18 of 139
    Layer Name:res2b_branch2c Type:Convolution
    Inputs: ['res2b_branch2b'], Outputs: ['res2b_branch2c']
    Quantizing conv input layer ... res2b_branch2c
    Threshold in shape= ()
    Quantizing conv weights for layer res2b_branch2c...
    Threshold params shape= (256,)
    n:  32768 , len(bin_edges):  2536
    Mean : th_layer_out:  16.071224212646484 , sf_layer_out:  0.0004904698084245273
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  2536
    Mean : th_layer_out:  16.071224212646484 , sf_layer_out:  0.0004904698084245273
    bw_layer_in:  16
    th_layer_in:  9.34158992767334
    bw_layer_out:  16
    th_layer_out:  16.071224212646484
    --------------------------------------------------------------------------------
    Processing layer 19 of 139
    Layer Name:res2b Type:Eltwise
    Inputs: ['res2a_res2a_relu_0_split_1', 'res2b_branch2c'], Outputs: ['res2b']
    bw_layer_in:  16
    th_layer_in:  16.74026107788086
    bw_layer_out:  16
    th_layer_out:  16.74026107788086
    --------------------------------------------------------------------------------
    Processing layer 20 of 139
    Layer Name:res2b_relu Type:ReLU
    Inputs: ['res2b'], Outputs: ['res2b']
    n:  32768 , len(bin_edges):  2536
    Mean : th_layer_out:  17.027891159057617 , sf_layer_out:  0.0005196658576939487
    bw_layer_out:  16
    th_layer_out:  17.027891159057617
    --------------------------------------------------------------------------------
    Processing layer 21 of 139
    Layer Name:res2b_res2b_relu_0_split Type:Split
    Inputs: ['res2b'], Outputs: ['res2b_res2b_relu_0_split_0', 'res2b_res2b_relu_0_split_1']
    bw_layer_in:  16
    th_layer_in:  17.027891159057617
    bw_layer_out:  16
    th_layer_out:  17.027891159057617
    --------------------------------------------------------------------------------
    Processing layer 22 of 139
    Layer Name:res2c_branch2a Type:Convolution
    Inputs: ['res2b_res2b_relu_0_split_0'], Outputs: ['res2c_branch2a']
    Quantizing conv input layer ... res2c_branch2a
    Threshold in shape= ()
    Quantizing conv weights for layer res2c_branch2a...
    Threshold params shape= (64,)
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  12.750967025756836 , sf_layer_out:  0.00038914050800368773
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  12.750967025756836 , sf_layer_out:  0.00038914050800368773
    bw_layer_in:  16
    th_layer_in:  17.027891159057617
    bw_layer_out:  16
    th_layer_out:  12.750967025756836
    --------------------------------------------------------------------------------
    Processing layer 23 of 139
    Layer Name:res2c_branch2a_relu Type:ReLU
    Inputs: ['res2c_branch2a'], Outputs: ['res2c_branch2a']
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  9.025151252746582 , sf_layer_out:  0.0002754341640292545
    bw_layer_out:  16
    th_layer_out:  9.025151252746582
    --------------------------------------------------------------------------------
    Processing layer 24 of 139
    Layer Name:res2c_branch2b Type:Convolution
    Inputs: ['res2c_branch2a'], Outputs: ['res2c_branch2b']
    Quantizing conv input layer ... res2c_branch2b
    Threshold in shape= ()
    Quantizing conv weights for layer res2c_branch2b...
    Threshold params shape= (64,)
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  11.728912353515625 , sf_layer_out:  0.00035794892280390715
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  11.728912353515625 , sf_layer_out:  0.00035794892280390715
    bw_layer_in:  16
    th_layer_in:  9.025151252746582
    bw_layer_out:  16
    th_layer_out:  11.728912353515625
    --------------------------------------------------------------------------------
    Processing layer 25 of 139
    Layer Name:res2c_branch2b_relu Type:ReLU
    Inputs: ['res2c_branch2b'], Outputs: ['res2c_branch2b']
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  11.728912353515625 , sf_layer_out:  0.00035794892280390715
    bw_layer_out:  16
    th_layer_out:  11.728912353515625
    --------------------------------------------------------------------------------
    Processing layer 26 of 139
    Layer Name:res2c_branch2c Type:Convolution
    Inputs: ['res2c_branch2b'], Outputs: ['res2c_branch2c']
    Quantizing conv input layer ... res2c_branch2c
    Threshold in shape= ()
    Quantizing conv weights for layer res2c_branch2c...
    Threshold params shape= (256,)
    n:  32768 , len(bin_edges):  2536
    Mean : th_layer_out:  16.856914520263672 , sf_layer_out:  0.0005144479055227416
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  2536
    Mean : th_layer_out:  16.856914520263672 , sf_layer_out:  0.0005144479055227416
    bw_layer_in:  16
    th_layer_in:  11.728912353515625
    bw_layer_out:  16
    th_layer_out:  16.856914520263672
    --------------------------------------------------------------------------------
    Processing layer 27 of 139
    Layer Name:res2c Type:Eltwise
    Inputs: ['res2b_res2b_relu_0_split_1', 'res2c_branch2c'], Outputs: ['res2c']
    bw_layer_in:  16
    th_layer_in:  17.027891159057617
    bw_layer_out:  16
    th_layer_out:  17.027891159057617
    --------------------------------------------------------------------------------
    Processing layer 28 of 139
    Layer Name:res2c_relu Type:ReLU
    Inputs: ['res2c'], Outputs: ['res2c']
    n:  32768 , len(bin_edges):  2536
    Mean : th_layer_out:  17.449859619140625 , sf_layer_out:  0.000532543706141564
    bw_layer_out:  16
    th_layer_out:  17.449859619140625
    --------------------------------------------------------------------------------
    Processing layer 29 of 139
    Layer Name:res2c_res2c_relu_0_split Type:Split
    Inputs: ['res2c'], Outputs: ['res2c_res2c_relu_0_split_0', 'res2c_res2c_relu_0_split_1']
    bw_layer_in:  16
    th_layer_in:  17.449859619140625
    bw_layer_out:  16
    th_layer_out:  17.449859619140625
    --------------------------------------------------------------------------------
    Processing layer 30 of 139
    Layer Name:res3a_branch1 Type:Convolution
    Inputs: ['res2c_res2c_relu_0_split_0'], Outputs: ['res3a_branch1']
    Quantizing conv input layer ... res3a_branch1
    Threshold in shape= ()
    Quantizing conv weights for layer res3a_branch1...
    Threshold params shape= (512,)
    n:  32768 , len(bin_edges):  1794
    Mean : th_layer_out:  18.52775764465332 , sf_layer_out:  0.0005654395472473318
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  1794
    Mean : th_layer_out:  18.52775764465332 , sf_layer_out:  0.0005654395472473318
    bw_layer_in:  16
    th_layer_in:  17.449859619140625
    bw_layer_out:  16
    th_layer_out:  18.52775764465332
    --------------------------------------------------------------------------------
    Processing layer 31 of 139
    Layer Name:res3a_branch2a Type:Convolution
    Inputs: ['res2c_res2c_relu_0_split_1'], Outputs: ['res3a_branch2a']
    Quantizing conv input layer ... res3a_branch2a
    Threshold in shape= ()
    Quantizing conv weights for layer res3a_branch2a...
    Threshold params shape= (128,)
    n:  32768 , len(bin_edges):  898
    Mean : th_layer_out:  9.101306915283203 , sf_layer_out:  0.00027775832133802923
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  898
    Mean : th_layer_out:  9.101306915283203 , sf_layer_out:  0.00027775832133802923
    bw_layer_in:  16
    th_layer_in:  17.449859619140625
    bw_layer_out:  16
    th_layer_out:  9.101306915283203
    --------------------------------------------------------------------------------
    Processing layer 32 of 139
    Layer Name:res3a_branch2a_relu Type:ReLU
    Inputs: ['res3a_branch2a'], Outputs: ['res3a_branch2a']
    n:  32768 , len(bin_edges):  897
    Mean : th_layer_out:  8.936604499816895 , sf_layer_out:  0.000272731849110901
    bw_layer_out:  16
    th_layer_out:  8.936604499816895
    --------------------------------------------------------------------------------
    Processing layer 33 of 139
    Layer Name:res3a_branch2b Type:Convolution
    Inputs: ['res3a_branch2a'], Outputs: ['res3a_branch2b']
    Quantizing conv input layer ... res3a_branch2b
    Threshold in shape= ()
    Quantizing conv weights for layer res3a_branch2b...
    Threshold params shape= (128,)
    n:  32768 , len(bin_edges):  897
    Mean : th_layer_out:  9.110977172851562 , sf_layer_out:  0.00027805344318526453
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  897
    Mean : th_layer_out:  9.110977172851562 , sf_layer_out:  0.00027805344318526453
    bw_layer_in:  16
    th_layer_in:  8.936604499816895
    bw_layer_out:  16
    th_layer_out:  9.110977172851562
    --------------------------------------------------------------------------------
    Processing layer 34 of 139
    Layer Name:res3a_branch2b_relu Type:ReLU
    Inputs: ['res3a_branch2b'], Outputs: ['res3a_branch2b']
    n:  32768 , len(bin_edges):  897
    Mean : th_layer_out:  7.3644795417785645 , sf_layer_out:  0.00022475293868155658
    bw_layer_out:  16
    th_layer_out:  7.3644795417785645
    --------------------------------------------------------------------------------
    Processing layer 35 of 139
    Layer Name:res3a_branch2c Type:Convolution
    Inputs: ['res3a_branch2b'], Outputs: ['res3a_branch2c']
    Quantizing conv input layer ... res3a_branch2c
    Threshold in shape= ()
    Quantizing conv weights for layer res3a_branch2c...
    Threshold params shape= (512,)
    n:  32768 , len(bin_edges):  1793
    Mean : th_layer_out:  17.476903915405273 , sf_layer_out:  0.0005333690577533882
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  1793
    Mean : th_layer_out:  17.476903915405273 , sf_layer_out:  0.0005333690577533882
    bw_layer_in:  16
    th_layer_in:  7.3644795417785645
    bw_layer_out:  16
    th_layer_out:  17.476903915405273
    --------------------------------------------------------------------------------
    Processing layer 36 of 139
    Layer Name:res3a Type:Eltwise
    Inputs: ['res3a_branch1', 'res3a_branch2c'], Outputs: ['res3a']
    bw_layer_in:  16
    th_layer_in:  18.52775764465332
    bw_layer_out:  16
    th_layer_out:  18.52775764465332
    --------------------------------------------------------------------------------
    Processing layer 37 of 139
    Layer Name:res3a_relu Type:ReLU
    Inputs: ['res3a'], Outputs: ['res3a']
    n:  32768 , len(bin_edges):  1793
    Mean : th_layer_out:  20.07366943359375 , sf_layer_out:  0.0006126184708271661
    bw_layer_out:  16
    th_layer_out:  20.07366943359375
    --------------------------------------------------------------------------------
    Processing layer 38 of 139
    Layer Name:res3a_res3a_relu_0_split Type:Split
    Inputs: ['res3a'], Outputs: ['res3a_res3a_relu_0_split_0', 'res3a_res3a_relu_0_split_1']
    bw_layer_in:  16
    th_layer_in:  20.07366943359375
    bw_layer_out:  16
    th_layer_out:  20.07366943359375
    --------------------------------------------------------------------------------
    Processing layer 39 of 139
    Layer Name:res3b_branch2a Type:Convolution
    Inputs: ['res3a_res3a_relu_0_split_0'], Outputs: ['res3b_branch2a']
    Quantizing conv input layer ... res3b_branch2a
    Threshold in shape= ()
    Quantizing conv weights for layer res3b_branch2a...
    Threshold params shape= (128,)
    n:  32768 , len(bin_edges):  898
    Mean : th_layer_out:  7.8711018562316895 , sf_layer_out:  0.0002402142965859459
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  898
    Mean : th_layer_out:  7.8711018562316895 , sf_layer_out:  0.0002402142965859459
    bw_layer_in:  16
    th_layer_in:  20.07366943359375
    bw_layer_out:  16
    th_layer_out:  7.8711018562316895
    --------------------------------------------------------------------------------
    Processing layer 40 of 139
    Layer Name:res3b_branch2a_relu Type:ReLU
    Inputs: ['res3b_branch2a'], Outputs: ['res3b_branch2a']
    n:  32768 , len(bin_edges):  897
    Mean : th_layer_out:  7.8711018562316895 , sf_layer_out:  0.0002402142965859459
    bw_layer_out:  16
    th_layer_out:  7.8711018562316895
    --------------------------------------------------------------------------------
    Processing layer 41 of 139
    Layer Name:res3b_branch2b Type:Convolution
    Inputs: ['res3b_branch2a'], Outputs: ['res3b_branch2b']
    Quantizing conv input layer ... res3b_branch2b
    Threshold in shape= ()
    Quantizing conv weights for layer res3b_branch2b...
    Threshold params shape= (128,)
    n:  32768 , len(bin_edges):  898
    Mean : th_layer_out:  12.130916595458984 , sf_layer_out:  0.0003702174930710466
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  898
    Mean : th_layer_out:  12.130916595458984 , sf_layer_out:  0.0003702174930710466
    bw_layer_in:  16
    th_layer_in:  7.8711018562316895
    bw_layer_out:  16
    th_layer_out:  12.130916595458984
    --------------------------------------------------------------------------------
    Processing layer 42 of 139
    Layer Name:res3b_branch2b_relu Type:ReLU
    Inputs: ['res3b_branch2b'], Outputs: ['res3b_branch2b']
    n:  32768 , len(bin_edges):  897
    Mean : th_layer_out:  8.849625587463379 , sf_layer_out:  0.00027007738235002834
    bw_layer_out:  16
    th_layer_out:  8.849625587463379
    --------------------------------------------------------------------------------
    Processing layer 43 of 139
    Layer Name:res3b_branch2c Type:Convolution
    Inputs: ['res3b_branch2b'], Outputs: ['res3b_branch2c']
    Quantizing conv input layer ... res3b_branch2c
    Threshold in shape= ()
    Quantizing conv weights for layer res3b_branch2c...
    Threshold params shape= (512,)
    n:  32768 , len(bin_edges):  1793
    Mean : th_layer_out:  11.5338716506958 , sf_layer_out:  0.00035199657126669517
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  1793
    Mean : th_layer_out:  11.5338716506958 , sf_layer_out:  0.00035199657126669517
    bw_layer_in:  16
    th_layer_in:  8.849625587463379
    bw_layer_out:  16
    th_layer_out:  11.5338716506958
    --------------------------------------------------------------------------------
    Processing layer 44 of 139
    Layer Name:res3b Type:Eltwise
    Inputs: ['res3a_res3a_relu_0_split_1', 'res3b_branch2c'], Outputs: ['res3b']
    bw_layer_in:  16
    th_layer_in:  20.07366943359375
    bw_layer_out:  16
    th_layer_out:  20.07366943359375
    --------------------------------------------------------------------------------
    Processing layer 45 of 139
    Layer Name:res3b_relu Type:ReLU
    Inputs: ['res3b'], Outputs: ['res3b']
    n:  32768 , len(bin_edges):  1793
    Mean : th_layer_out:  21.10593032836914 , sf_layer_out:  0.0006441215347260702
    bw_layer_out:  16
    th_layer_out:  21.10593032836914
    --------------------------------------------------------------------------------
    Processing layer 46 of 139
    Layer Name:res3b_res3b_relu_0_split Type:Split
    Inputs: ['res3b'], Outputs: ['res3b_res3b_relu_0_split_0', 'res3b_res3b_relu_0_split_1']
    bw_layer_in:  16
    th_layer_in:  21.10593032836914
    bw_layer_out:  16
    th_layer_out:  21.10593032836914
    --------------------------------------------------------------------------------
    Processing layer 47 of 139
    Layer Name:res3c_branch2a Type:Convolution
    Inputs: ['res3b_res3b_relu_0_split_0'], Outputs: ['res3c_branch2a']
    Quantizing conv input layer ... res3c_branch2a
    Threshold in shape= ()
    Quantizing conv weights for layer res3c_branch2a...
    Threshold params shape= (128,)
    n:  32768 , len(bin_edges):  898
    Mean : th_layer_out:  10.769893646240234 , sf_layer_out:  0.00032868110129826453
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  898
    Mean : th_layer_out:  10.769893646240234 , sf_layer_out:  0.00032868110129826453
    bw_layer_in:  16
    th_layer_in:  21.10593032836914
    bw_layer_out:  16
    th_layer_out:  10.769893646240234
    --------------------------------------------------------------------------------
    Processing layer 48 of 139
    Layer Name:res3c_branch2a_relu Type:ReLU
    Inputs: ['res3c_branch2a'], Outputs: ['res3c_branch2a']
    n:  32768 , len(bin_edges):  897
    Mean : th_layer_out:  6.071372032165527 , sf_layer_out:  0.00018528922489594797
    bw_layer_out:  16
    th_layer_out:  6.071372032165527
    --------------------------------------------------------------------------------
    Processing layer 49 of 139
    Layer Name:res3c_branch2b Type:Convolution
    Inputs: ['res3c_branch2a'], Outputs: ['res3c_branch2b']
    Quantizing conv input layer ... res3c_branch2b
    Threshold in shape= ()
    Quantizing conv weights for layer res3c_branch2b...
    Threshold params shape= (128,)
    n:  32768 , len(bin_edges):  898
    Mean : th_layer_out:  12.493988037109375 , sf_layer_out:  0.000381297892303518
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  898
    Mean : th_layer_out:  12.493988037109375 , sf_layer_out:  0.000381297892303518
    bw_layer_in:  16
    th_layer_in:  6.071372032165527
    bw_layer_out:  16
    th_layer_out:  12.493988037109375
    --------------------------------------------------------------------------------
    Processing layer 50 of 139
    Layer Name:res3c_branch2b_relu Type:ReLU
    Inputs: ['res3c_branch2b'], Outputs: ['res3c_branch2b']
    n:  32768 , len(bin_edges):  897
    Mean : th_layer_out:  11.205114364624023 , sf_layer_out:  0.0003419633889164105
    bw_layer_out:  16
    th_layer_out:  11.205114364624023
    --------------------------------------------------------------------------------
    Processing layer 51 of 139
    Layer Name:res3c_branch2c Type:Convolution
    Inputs: ['res3c_branch2b'], Outputs: ['res3c_branch2c']
    Quantizing conv input layer ... res3c_branch2c
    Threshold in shape= ()
    Quantizing conv weights for layer res3c_branch2c...
    Threshold params shape= (512,)
    n:  32768 , len(bin_edges):  1793
    Mean : th_layer_out:  25.55634307861328 , sf_layer_out:  0.0007799414984164946
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  1793
    Mean : th_layer_out:  25.55634307861328 , sf_layer_out:  0.0007799414984164946
    bw_layer_in:  16
    th_layer_in:  11.205114364624023
    bw_layer_out:  16
    th_layer_out:  25.55634307861328
    --------------------------------------------------------------------------------
    Processing layer 52 of 139
    Layer Name:res3c Type:Eltwise
    Inputs: ['res3b_res3b_relu_0_split_1', 'res3c_branch2c'], Outputs: ['res3c']
    bw_layer_in:  16
    th_layer_in:  25.55634307861328
    bw_layer_out:  16
    th_layer_out:  25.55634307861328
    --------------------------------------------------------------------------------
    Processing layer 53 of 139
    Layer Name:res3c_relu Type:ReLU
    Inputs: ['res3c'], Outputs: ['res3c']
    n:  32768 , len(bin_edges):  1793
    Mean : th_layer_out:  25.085376739501953 , sf_layer_out:  0.0007655683077334499
    bw_layer_out:  16
    th_layer_out:  25.085376739501953
    --------------------------------------------------------------------------------
    Processing layer 54 of 139
    Layer Name:res3c_res3c_relu_0_split Type:Split
    Inputs: ['res3c'], Outputs: ['res3c_res3c_relu_0_split_0', 'res3c_res3c_relu_0_split_1']
    bw_layer_in:  16
    th_layer_in:  25.085376739501953
    bw_layer_out:  16
    th_layer_out:  25.085376739501953
    --------------------------------------------------------------------------------
    Processing layer 55 of 139
    Layer Name:res3d_branch2a Type:Convolution
    Inputs: ['res3c_res3c_relu_0_split_0'], Outputs: ['res3d_branch2a']
    Quantizing conv input layer ... res3d_branch2a
    Threshold in shape= ()
    Quantizing conv weights for layer res3d_branch2a...
    Threshold params shape= (128,)
    n:  32768 , len(bin_edges):  898
    Mean : th_layer_out:  19.343761444091797 , sf_layer_out:  0.0005903427669329447
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  898
    Mean : th_layer_out:  19.343761444091797 , sf_layer_out:  0.0005903427669329447
    bw_layer_in:  16
    th_layer_in:  25.085376739501953
    bw_layer_out:  16
    th_layer_out:  19.343761444091797
    --------------------------------------------------------------------------------
    Processing layer 56 of 139
    Layer Name:res3d_branch2a_relu Type:ReLU
    Inputs: ['res3d_branch2a'], Outputs: ['res3d_branch2a']
    n:  32768 , len(bin_edges):  897
    Mean : th_layer_out:  13.85445499420166 , sf_layer_out:  0.00042281731602532
    bw_layer_out:  16
    th_layer_out:  13.85445499420166
    --------------------------------------------------------------------------------
    Processing layer 57 of 139
    Layer Name:res3d_branch2b Type:Convolution
    Inputs: ['res3d_branch2a'], Outputs: ['res3d_branch2b']
    Quantizing conv input layer ... res3d_branch2b
    Threshold in shape= ()
    Quantizing conv weights for layer res3d_branch2b...
    Threshold params shape= (128,)
    n:  32768 , len(bin_edges):  897
    Mean : th_layer_out:  12.202136993408203 , sf_layer_out:  0.0003723910334607441
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  897
    Mean : th_layer_out:  12.202136993408203 , sf_layer_out:  0.0003723910334607441
    bw_layer_in:  16
    th_layer_in:  13.85445499420166
    bw_layer_out:  16
    th_layer_out:  12.202136993408203
    --------------------------------------------------------------------------------
    Processing layer 58 of 139
    Layer Name:res3d_branch2b_relu Type:ReLU
    Inputs: ['res3d_branch2b'], Outputs: ['res3d_branch2b']
    n:  32768 , len(bin_edges):  897
    Mean : th_layer_out:  12.202136993408203 , sf_layer_out:  0.0003723910334607441
    bw_layer_out:  16
    th_layer_out:  12.202136993408203
    --------------------------------------------------------------------------------
    Processing layer 59 of 139
    Layer Name:res3d_branch2c Type:Convolution
    Inputs: ['res3d_branch2b'], Outputs: ['res3d_branch2c']
    Quantizing conv input layer ... res3d_branch2c
    Threshold in shape= ()
    Quantizing conv weights for layer res3d_branch2c...
    Threshold params shape= (512,)
    n:  32768 , len(bin_edges):  1793
    Mean : th_layer_out:  11.993475914001465 , sf_layer_out:  0.00036602300833159777
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  1793
    Mean : th_layer_out:  11.993475914001465 , sf_layer_out:  0.00036602300833159777
    bw_layer_in:  16
    th_layer_in:  12.202136993408203
    bw_layer_out:  16
    th_layer_out:  11.993475914001465
    --------------------------------------------------------------------------------
    Processing layer 60 of 139
    Layer Name:res3d Type:Eltwise
    Inputs: ['res3c_res3c_relu_0_split_1', 'res3d_branch2c'], Outputs: ['res3d']
    bw_layer_in:  16
    th_layer_in:  25.085376739501953
    bw_layer_out:  16
    th_layer_out:  25.085376739501953
    --------------------------------------------------------------------------------
    Processing layer 61 of 139
    Layer Name:res3d_relu Type:ReLU
    Inputs: ['res3d'], Outputs: ['res3d']
    n:  32768 , len(bin_edges):  1793
    Mean : th_layer_out:  23.62237548828125 , sf_layer_out:  0.0007209196901846751
    bw_layer_out:  16
    th_layer_out:  23.62237548828125
    --------------------------------------------------------------------------------
    Processing layer 62 of 139
    Layer Name:res3d_res3d_relu_0_split Type:Split
    Inputs: ['res3d'], Outputs: ['res3d_res3d_relu_0_split_0', 'res3d_res3d_relu_0_split_1']
    bw_layer_in:  16
    th_layer_in:  23.62237548828125
    bw_layer_out:  16
    th_layer_out:  23.62237548828125
    --------------------------------------------------------------------------------
    Processing layer 63 of 139
    Layer Name:res4a_branch1 Type:Convolution
    Inputs: ['res3d_res3d_relu_0_split_0'], Outputs: ['res4a_branch1']
    Quantizing conv input layer ... res4a_branch1
    Threshold in shape= ()
    Quantizing conv weights for layer res4a_branch1...
    Threshold params shape= (1024,)
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  19.360361099243164 , sf_layer_out:  0.0005908493636659799
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  19.360361099243164 , sf_layer_out:  0.0005908493636659799
    bw_layer_in:  16
    th_layer_in:  23.62237548828125
    bw_layer_out:  16
    th_layer_out:  19.360361099243164
    --------------------------------------------------------------------------------
    Processing layer 64 of 139
    Layer Name:res4a_branch2a Type:Convolution
    Inputs: ['res3d_res3d_relu_0_split_1'], Outputs: ['res4a_branch2a']
    Quantizing conv input layer ... res4a_branch2a
    Threshold in shape= ()
    Quantizing conv weights for layer res4a_branch2a...
    Threshold params shape= (256,)
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  8.966886520385742 , sf_layer_out:  0.00027365601124258374
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  8.966886520385742 , sf_layer_out:  0.00027365601124258374
    bw_layer_in:  16
    th_layer_in:  23.62237548828125
    bw_layer_out:  16
    th_layer_out:  8.966886520385742
    --------------------------------------------------------------------------------
    Processing layer 65 of 139
    Layer Name:res4a_branch2a_relu Type:ReLU
    Inputs: ['res4a_branch2a'], Outputs: ['res4a_branch2a']
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  8.966886520385742 , sf_layer_out:  0.00027365601124258374
    bw_layer_out:  16
    th_layer_out:  8.966886520385742
    --------------------------------------------------------------------------------
    Processing layer 66 of 139
    Layer Name:res4a_branch2b Type:Convolution
    Inputs: ['res4a_branch2a'], Outputs: ['res4a_branch2b']
    Quantizing conv input layer ... res4a_branch2b
    Threshold in shape= ()
    Quantizing conv weights for layer res4a_branch2b...
    Threshold params shape= (256,)
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  8.485054016113281 , sf_layer_out:  0.0002589512013951012
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  8.485054016113281 , sf_layer_out:  0.0002589512013951012
    bw_layer_in:  16
    th_layer_in:  8.966886520385742
    bw_layer_out:  16
    th_layer_out:  8.485054016113281
    --------------------------------------------------------------------------------
    Processing layer 67 of 139
    Layer Name:res4a_branch2b_relu Type:ReLU
    Inputs: ['res4a_branch2b'], Outputs: ['res4a_branch2b']
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  7.337042808532715 , sf_layer_out:  0.00022391561047800272
    bw_layer_out:  16
    th_layer_out:  7.337042808532715
    --------------------------------------------------------------------------------
    Processing layer 68 of 139
    Layer Name:res4a_branch2c Type:Convolution
    Inputs: ['res4a_branch2b'], Outputs: ['res4a_branch2c']
    Quantizing conv input layer ... res4a_branch2c
    Threshold in shape= ()
    Quantizing conv weights for layer res4a_branch2c...
    Threshold params shape= (1024,)
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  13.620804786682129 , sf_layer_out:  0.00041568665995306644
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  13.620804786682129 , sf_layer_out:  0.00041568665995306644
    bw_layer_in:  16
    th_layer_in:  7.337042808532715
    bw_layer_out:  16
    th_layer_out:  13.620804786682129
    --------------------------------------------------------------------------------
    Processing layer 69 of 139
    Layer Name:res4a Type:Eltwise
    Inputs: ['res4a_branch1', 'res4a_branch2c'], Outputs: ['res4a']
    bw_layer_in:  16
    th_layer_in:  19.360361099243164
    bw_layer_out:  16
    th_layer_out:  19.360361099243164
    --------------------------------------------------------------------------------
    Processing layer 70 of 139
    Layer Name:res4a_relu Type:ReLU
    Inputs: ['res4a'], Outputs: ['res4a']
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  19.6492862701416 , sf_layer_out:  0.000599666929231898
    bw_layer_out:  16
    th_layer_out:  19.6492862701416
    --------------------------------------------------------------------------------
    Processing layer 71 of 139
    Layer Name:res4a_res4a_relu_0_split Type:Split
    Inputs: ['res4a'], Outputs: ['res4a_res4a_relu_0_split_0', 'res4a_res4a_relu_0_split_1']
    bw_layer_in:  16
    th_layer_in:  19.6492862701416
    bw_layer_out:  16
    th_layer_out:  19.6492862701416
    --------------------------------------------------------------------------------
    Processing layer 72 of 139
    Layer Name:res4b_branch2a Type:Convolution
    Inputs: ['res4a_res4a_relu_0_split_0'], Outputs: ['res4b_branch2a']
    Quantizing conv input layer ... res4b_branch2a
    Threshold in shape= ()
    Quantizing conv weights for layer res4b_branch2a...
    Threshold params shape= (256,)
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  8.626448631286621 , sf_layer_out:  0.0002632663542981238
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  8.626448631286621 , sf_layer_out:  0.0002632663542981238
    bw_layer_in:  16
    th_layer_in:  19.6492862701416
    bw_layer_out:  16
    th_layer_out:  8.626448631286621
    --------------------------------------------------------------------------------
    Processing layer 73 of 139
    Layer Name:res4b_branch2a_relu Type:ReLU
    Inputs: ['res4b_branch2a'], Outputs: ['res4b_branch2a']
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  8.305667877197266 , sf_layer_out:  0.00025347660381473024
    bw_layer_out:  16
    th_layer_out:  8.305667877197266
    --------------------------------------------------------------------------------
    Processing layer 74 of 139
    Layer Name:res4b_branch2b Type:Convolution
    Inputs: ['res4b_branch2a'], Outputs: ['res4b_branch2b']
    Quantizing conv input layer ... res4b_branch2b
    Threshold in shape= ()
    Quantizing conv weights for layer res4b_branch2b...
    Threshold params shape= (256,)
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  8.932904243469238 , sf_layer_out:  0.00027261892280249146
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  8.932904243469238 , sf_layer_out:  0.00027261892280249146
    bw_layer_in:  16
    th_layer_in:  8.305667877197266
    bw_layer_out:  16
    th_layer_out:  8.932904243469238
    --------------------------------------------------------------------------------
    Processing layer 75 of 139
    Layer Name:res4b_branch2b_relu Type:ReLU
    Inputs: ['res4b_branch2b'], Outputs: ['res4b_branch2b']
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  7.4848480224609375 , sf_layer_out:  0.00022842640529987298
    bw_layer_out:  16
    th_layer_out:  7.4848480224609375
    --------------------------------------------------------------------------------
    Processing layer 76 of 139
    Layer Name:res4b_branch2c Type:Convolution
    Inputs: ['res4b_branch2b'], Outputs: ['res4b_branch2c']
    Quantizing conv input layer ... res4b_branch2c
    Threshold in shape= ()
    Quantizing conv weights for layer res4b_branch2c...
    Threshold params shape= (1024,)
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  11.545816421508789 , sf_layer_out:  0.00035236110786794
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  11.545816421508789 , sf_layer_out:  0.00035236110786794
    bw_layer_in:  16
    th_layer_in:  7.4848480224609375
    bw_layer_out:  16
    th_layer_out:  11.545816421508789
    --------------------------------------------------------------------------------
    Processing layer 77 of 139
    Layer Name:res4b Type:Eltwise
    Inputs: ['res4a_res4a_relu_0_split_1', 'res4b_branch2c'], Outputs: ['res4b']
    bw_layer_in:  16
    th_layer_in:  19.6492862701416
    bw_layer_out:  16
    th_layer_out:  19.6492862701416
    --------------------------------------------------------------------------------
    Processing layer 78 of 139
    Layer Name:res4b_relu Type:ReLU
    Inputs: ['res4b'], Outputs: ['res4b']
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  18.463144302368164 , sf_layer_out:  0.0005634676443485264
    bw_layer_out:  16
    th_layer_out:  18.463144302368164
    --------------------------------------------------------------------------------
    Processing layer 79 of 139
    Layer Name:res4b_res4b_relu_0_split Type:Split
    Inputs: ['res4b'], Outputs: ['res4b_res4b_relu_0_split_0', 'res4b_res4b_relu_0_split_1']
    bw_layer_in:  16
    th_layer_in:  18.463144302368164
    bw_layer_out:  16
    th_layer_out:  18.463144302368164
    --------------------------------------------------------------------------------
    Processing layer 80 of 139
    Layer Name:res4c_branch2a Type:Convolution
    Inputs: ['res4b_res4b_relu_0_split_0'], Outputs: ['res4c_branch2a']
    Quantizing conv input layer ... res4c_branch2a
    Threshold in shape= ()
    Quantizing conv weights for layer res4c_branch2a...
    Threshold params shape= (256,)
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  10.622591972351074 , sf_layer_out:  0.00032418567376784794
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  10.622591972351074 , sf_layer_out:  0.00032418567376784794
    bw_layer_in:  16
    th_layer_in:  18.463144302368164
    bw_layer_out:  16
    th_layer_out:  10.622591972351074
    --------------------------------------------------------------------------------
    Processing layer 81 of 139
    Layer Name:res4c_branch2a_relu Type:ReLU
    Inputs: ['res4c_branch2a'], Outputs: ['res4c_branch2a']
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  9.837334632873535 , sf_layer_out:  0.00030022079021190635
    bw_layer_out:  16
    th_layer_out:  9.837334632873535
    --------------------------------------------------------------------------------
    Processing layer 82 of 139
    Layer Name:res4c_branch2b Type:Convolution
    Inputs: ['res4c_branch2a'], Outputs: ['res4c_branch2b']
    Quantizing conv input layer ... res4c_branch2b
    Threshold in shape= ()
    Quantizing conv weights for layer res4c_branch2b...
    Threshold params shape= (256,)
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  9.338618278503418 , sf_layer_out:  0.00028500071042522715
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  9.338618278503418 , sf_layer_out:  0.00028500071042522715
    bw_layer_in:  16
    th_layer_in:  9.837334632873535
    bw_layer_out:  16
    th_layer_out:  9.338618278503418
    --------------------------------------------------------------------------------
    Processing layer 83 of 139
    Layer Name:res4c_branch2b_relu Type:ReLU
    Inputs: ['res4c_branch2b'], Outputs: ['res4c_branch2b']
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  9.338618278503418 , sf_layer_out:  0.00028500071042522715
    bw_layer_out:  16
    th_layer_out:  9.338618278503418
    --------------------------------------------------------------------------------
    Processing layer 84 of 139
    Layer Name:res4c_branch2c Type:Convolution
    Inputs: ['res4c_branch2b'], Outputs: ['res4c_branch2c']
    Quantizing conv input layer ... res4c_branch2c
    Threshold in shape= ()
    Quantizing conv weights for layer res4c_branch2c...
    Threshold params shape= (1024,)
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  12.992647171020508 , sf_layer_out:  0.0003965162258070775
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  12.992647171020508 , sf_layer_out:  0.0003965162258070775
    bw_layer_in:  16
    th_layer_in:  9.338618278503418
    bw_layer_out:  16
    th_layer_out:  12.992647171020508
    --------------------------------------------------------------------------------
    Processing layer 85 of 139
    Layer Name:res4c Type:Eltwise
    Inputs: ['res4b_res4b_relu_0_split_1', 'res4c_branch2c'], Outputs: ['res4c']
    bw_layer_in:  16
    th_layer_in:  18.463144302368164
    bw_layer_out:  16
    th_layer_out:  18.463144302368164
    --------------------------------------------------------------------------------
    Processing layer 86 of 139
    Layer Name:res4c_relu Type:ReLU
    Inputs: ['res4c'], Outputs: ['res4c']
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  19.759119033813477 , sf_layer_out:  0.0006030188614707931
    bw_layer_out:  16
    th_layer_out:  19.759119033813477
    --------------------------------------------------------------------------------
    Processing layer 87 of 139
    Layer Name:res4c_res4c_relu_0_split Type:Split
    Inputs: ['res4c'], Outputs: ['res4c_res4c_relu_0_split_0', 'res4c_res4c_relu_0_split_1']
    bw_layer_in:  16
    th_layer_in:  19.759119033813477
    bw_layer_out:  16
    th_layer_out:  19.759119033813477
    --------------------------------------------------------------------------------
    Processing layer 88 of 139
    Layer Name:res4d_branch2a Type:Convolution
    Inputs: ['res4c_res4c_relu_0_split_0'], Outputs: ['res4d_branch2a']
    Quantizing conv input layer ... res4d_branch2a
    Threshold in shape= ()
    Quantizing conv weights for layer res4d_branch2a...
    Threshold params shape= (256,)
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  9.873241424560547 , sf_layer_out:  0.00030131661197425907
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  9.873241424560547 , sf_layer_out:  0.00030131661197425907
    bw_layer_in:  16
    th_layer_in:  19.759119033813477
    bw_layer_out:  16
    th_layer_out:  9.873241424560547
    --------------------------------------------------------------------------------
    Processing layer 89 of 139
    Layer Name:res4d_branch2a_relu Type:ReLU
    Inputs: ['res4d_branch2a'], Outputs: ['res4d_branch2a']
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  9.873241424560547 , sf_layer_out:  0.00030131661197425907
    bw_layer_out:  16
    th_layer_out:  9.873241424560547
    --------------------------------------------------------------------------------
    Processing layer 90 of 139
    Layer Name:res4d_branch2b Type:Convolution
    Inputs: ['res4d_branch2a'], Outputs: ['res4d_branch2b']
    Quantizing conv input layer ... res4d_branch2b
    Threshold in shape= ()
    Quantizing conv weights for layer res4d_branch2b...
    Threshold params shape= (256,)
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  9.070762634277344 , sf_layer_out:  0.00027682615540871436
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  9.070762634277344 , sf_layer_out:  0.00027682615540871436
    bw_layer_in:  16
    th_layer_in:  9.873241424560547
    bw_layer_out:  16
    th_layer_out:  9.070762634277344
    --------------------------------------------------------------------------------
    Processing layer 91 of 139
    Layer Name:res4d_branch2b_relu Type:ReLU
    Inputs: ['res4d_branch2b'], Outputs: ['res4d_branch2b']
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  7.584280967712402 , sf_layer_out:  0.00023146095058175611
    bw_layer_out:  16
    th_layer_out:  7.584280967712402
    --------------------------------------------------------------------------------
    Processing layer 92 of 139
    Layer Name:res4d_branch2c Type:Convolution
    Inputs: ['res4d_branch2b'], Outputs: ['res4d_branch2c']
    Quantizing conv input layer ... res4d_branch2c
    Threshold in shape= ()
    Quantizing conv weights for layer res4d_branch2c...
    Threshold params shape= (1024,)
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  10.989665031433105 , sf_layer_out:  0.0003353881963998262
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  10.989665031433105 , sf_layer_out:  0.0003353881963998262
    bw_layer_in:  16
    th_layer_in:  7.584280967712402
    bw_layer_out:  16
    th_layer_out:  10.989665031433105
    --------------------------------------------------------------------------------
    Processing layer 93 of 139
    Layer Name:res4d Type:Eltwise
    Inputs: ['res4c_res4c_relu_0_split_1', 'res4d_branch2c'], Outputs: ['res4d']
    bw_layer_in:  16
    th_layer_in:  19.759119033813477
    bw_layer_out:  16
    th_layer_out:  19.759119033813477
    --------------------------------------------------------------------------------
    Processing layer 94 of 139
    Layer Name:res4d_relu Type:ReLU
    Inputs: ['res4d'], Outputs: ['res4d']
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  22.689790725708008 , sf_layer_out:  0.000692458593270913
    bw_layer_out:  16
    th_layer_out:  22.689790725708008
    --------------------------------------------------------------------------------
    Processing layer 95 of 139
    Layer Name:res4d_res4d_relu_0_split Type:Split
    Inputs: ['res4d'], Outputs: ['res4d_res4d_relu_0_split_0', 'res4d_res4d_relu_0_split_1']
    bw_layer_in:  16
    th_layer_in:  22.689790725708008
    bw_layer_out:  16
    th_layer_out:  22.689790725708008
    --------------------------------------------------------------------------------
    Processing layer 96 of 139
    Layer Name:res4e_branch2a Type:Convolution
    Inputs: ['res4d_res4d_relu_0_split_0'], Outputs: ['res4e_branch2a']
    Quantizing conv input layer ... res4e_branch2a
    Threshold in shape= ()
    Quantizing conv weights for layer res4e_branch2a...
    Threshold params shape= (256,)
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  10.46467113494873 , sf_layer_out:  0.00031936616519512713
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  10.46467113494873 , sf_layer_out:  0.00031936616519512713
    bw_layer_in:  16
    th_layer_in:  22.689790725708008
    bw_layer_out:  16
    th_layer_out:  10.46467113494873
    --------------------------------------------------------------------------------
    Processing layer 97 of 139
    Layer Name:res4e_branch2a_relu Type:ReLU
    Inputs: ['res4e_branch2a'], Outputs: ['res4e_branch2a']
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  10.46467113494873 , sf_layer_out:  0.00031936616519512713
    bw_layer_out:  16
    th_layer_out:  10.46467113494873
    --------------------------------------------------------------------------------
    Processing layer 98 of 139
    Layer Name:res4e_branch2b Type:Convolution
    Inputs: ['res4e_branch2a'], Outputs: ['res4e_branch2b']
    Quantizing conv input layer ... res4e_branch2b
    Threshold in shape= ()
    Quantizing conv weights for layer res4e_branch2b...
    Threshold params shape= (256,)
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  13.17535400390625 , sf_layer_out:  0.00040209216601783045
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  13.17535400390625 , sf_layer_out:  0.00040209216601783045
    bw_layer_in:  16
    th_layer_in:  10.46467113494873
    bw_layer_out:  16
    th_layer_out:  13.17535400390625
    --------------------------------------------------------------------------------
    Processing layer 99 of 139
    Layer Name:res4e_branch2b_relu Type:ReLU
    Inputs: ['res4e_branch2b'], Outputs: ['res4e_branch2b']
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  13.17535400390625 , sf_layer_out:  0.00040209216601783045
    bw_layer_out:  16
    th_layer_out:  13.17535400390625
    --------------------------------------------------------------------------------
    Processing layer 100 of 139
    Layer Name:res4e_branch2c Type:Convolution
    Inputs: ['res4e_branch2b'], Outputs: ['res4e_branch2c']
    Quantizing conv input layer ... res4e_branch2c
    Threshold in shape= ()
    Quantizing conv weights for layer res4e_branch2c...
    Threshold params shape= (1024,)
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  11.740959167480469 , sf_layer_out:  0.0003583165736100488
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  11.740959167480469 , sf_layer_out:  0.0003583165736100488
    bw_layer_in:  16
    th_layer_in:  13.17535400390625
    bw_layer_out:  16
    th_layer_out:  11.740959167480469
    --------------------------------------------------------------------------------
    Processing layer 101 of 139
    Layer Name:res4e Type:Eltwise
    Inputs: ['res4d_res4d_relu_0_split_1', 'res4e_branch2c'], Outputs: ['res4e']
    bw_layer_in:  16
    th_layer_in:  22.689790725708008
    bw_layer_out:  16
    th_layer_out:  22.689790725708008
    --------------------------------------------------------------------------------
    Processing layer 102 of 139
    Layer Name:res4e_relu Type:ReLU
    Inputs: ['res4e'], Outputs: ['res4e']
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  24.08094024658203 , sf_layer_out:  0.0007349144031062359
    bw_layer_out:  16
    th_layer_out:  24.08094024658203
    --------------------------------------------------------------------------------
    Processing layer 103 of 139
    Layer Name:res4e_res4e_relu_0_split Type:Split
    Inputs: ['res4e'], Outputs: ['res4e_res4e_relu_0_split_0', 'res4e_res4e_relu_0_split_1']
    bw_layer_in:  16
    th_layer_in:  24.08094024658203
    bw_layer_out:  16
    th_layer_out:  24.08094024658203
    --------------------------------------------------------------------------------
    Processing layer 104 of 139
    Layer Name:res4f_branch2a Type:Convolution
    Inputs: ['res4e_res4e_relu_0_split_0'], Outputs: ['res4f_branch2a']
    Quantizing conv input layer ... res4f_branch2a
    Threshold in shape= ()
    Quantizing conv weights for layer res4f_branch2a...
    Threshold params shape= (256,)
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  10.858713150024414 , sf_layer_out:  0.0003313917401661554
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  10.858713150024414 , sf_layer_out:  0.0003313917401661554
    bw_layer_in:  16
    th_layer_in:  24.08094024658203
    bw_layer_out:  16
    th_layer_out:  10.858713150024414
    --------------------------------------------------------------------------------
    Processing layer 105 of 139
    Layer Name:res4f_branch2a_relu Type:ReLU
    Inputs: ['res4f_branch2a'], Outputs: ['res4f_branch2a']
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  10.858713150024414 , sf_layer_out:  0.0003313917401661554
    bw_layer_out:  16
    th_layer_out:  10.858713150024414
    --------------------------------------------------------------------------------
    Processing layer 106 of 139
    Layer Name:res4f_branch2b Type:Convolution
    Inputs: ['res4f_branch2a'], Outputs: ['res4f_branch2b']
    Quantizing conv input layer ... res4f_branch2b
    Threshold in shape= ()
    Quantizing conv weights for layer res4f_branch2b...
    Threshold params shape= (256,)
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  31.814891815185547 , sf_layer_out:  0.0009709430773395657
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  31.814891815185547 , sf_layer_out:  0.0009709430773395657
    bw_layer_in:  16
    th_layer_in:  10.858713150024414
    bw_layer_out:  16
    th_layer_out:  31.814891815185547
    --------------------------------------------------------------------------------
    Processing layer 107 of 139
    Layer Name:res4f_branch2b_relu Type:ReLU
    Inputs: ['res4f_branch2b'], Outputs: ['res4f_branch2b']
    n:  32768 , len(bin_edges):  635
    Mean : th_layer_out:  31.814891815185547 , sf_layer_out:  0.0009709430773395657
    bw_layer_out:  16
    th_layer_out:  31.814891815185547
    --------------------------------------------------------------------------------
    Processing layer 108 of 139
    Layer Name:res4f_branch2c Type:Convolution
    Inputs: ['res4f_branch2b'], Outputs: ['res4f_branch2c']
    Quantizing conv input layer ... res4f_branch2c
    Threshold in shape= ()
    Quantizing conv weights for layer res4f_branch2c...
    Threshold params shape= (1024,)
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  24.923065185546875 , sf_layer_out:  0.000760614801036008
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  24.923065185546875 , sf_layer_out:  0.000760614801036008
    bw_layer_in:  16
    th_layer_in:  31.814891815185547
    bw_layer_out:  16
    th_layer_out:  24.923065185546875
    --------------------------------------------------------------------------------
    Processing layer 109 of 139
    Layer Name:res4f Type:Eltwise
    Inputs: ['res4e_res4e_relu_0_split_1', 'res4f_branch2c'], Outputs: ['res4f']
    bw_layer_in:  16
    th_layer_in:  24.923065185546875
    bw_layer_out:  16
    th_layer_out:  24.923065185546875
    --------------------------------------------------------------------------------
    Processing layer 110 of 139
    Layer Name:res4f_relu Type:ReLU
    Inputs: ['res4f'], Outputs: ['res4f']
    n:  32768 , len(bin_edges):  1269
    Mean : th_layer_out:  24.923065185546875 , sf_layer_out:  0.000760614801036008
    bw_layer_out:  16
    th_layer_out:  24.923065185546875
    --------------------------------------------------------------------------------
    Processing layer 111 of 139
    Layer Name:res4f_res4f_relu_0_split Type:Split
    Inputs: ['res4f'], Outputs: ['res4f_res4f_relu_0_split_0', 'res4f_res4f_relu_0_split_1']
    bw_layer_in:  16
    th_layer_in:  24.923065185546875
    bw_layer_out:  16
    th_layer_out:  24.923065185546875
    --------------------------------------------------------------------------------
    Processing layer 112 of 139
    Layer Name:res5a_branch1 Type:Convolution
    Inputs: ['res4f_res4f_relu_0_split_0'], Outputs: ['res5a_branch1']
    Quantizing conv input layer ... res5a_branch1
    Threshold in shape= ()
    Quantizing conv weights for layer res5a_branch1...
    Threshold params shape= (2048,)
    n:  32768 , len(bin_edges):  898
    Mean : th_layer_out:  40.536643981933594 , sf_layer_out:  0.001237117953487765
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  898
    Mean : th_layer_out:  40.536643981933594 , sf_layer_out:  0.001237117953487765
    bw_layer_in:  16
    th_layer_in:  24.923065185546875
    bw_layer_out:  16
    th_layer_out:  40.536643981933594
    --------------------------------------------------------------------------------
    Processing layer 113 of 139
    Layer Name:res5a_branch2a Type:Convolution
    Inputs: ['res4f_res4f_relu_0_split_1'], Outputs: ['res5a_branch2a']
    Quantizing conv input layer ... res5a_branch2a
    Threshold in shape= ()
    Quantizing conv weights for layer res5a_branch2a...
    Threshold params shape= (512,)
    n:  32768 , len(bin_edges):  450
    Mean : th_layer_out:  8.57522201538086 , sf_layer_out:  0.0002617029943351805
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  450
    Mean : th_layer_out:  8.57522201538086 , sf_layer_out:  0.0002617029943351805
    bw_layer_in:  16
    th_layer_in:  24.923065185546875
    bw_layer_out:  16
    th_layer_out:  8.57522201538086
    --------------------------------------------------------------------------------
    Processing layer 114 of 139
    Layer Name:res5a_branch2a_relu Type:ReLU
    Inputs: ['res5a_branch2a'], Outputs: ['res5a_branch2a']
    n:  32768 , len(bin_edges):  450
    Mean : th_layer_out:  8.57522201538086 , sf_layer_out:  0.0002617029943351805
    bw_layer_out:  16
    th_layer_out:  8.57522201538086
    --------------------------------------------------------------------------------
    Processing layer 115 of 139
    Layer Name:res5a_branch2b Type:Convolution
    Inputs: ['res5a_branch2a'], Outputs: ['res5a_branch2b']
    Quantizing conv input layer ... res5a_branch2b
    Threshold in shape= ()
    Quantizing conv weights for layer res5a_branch2b...
    Threshold params shape= (512,)
    n:  32768 , len(bin_edges):  450
    Mean : th_layer_out:  10.095709800720215 , sf_layer_out:  0.0003081060152201976
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  450
    Mean : th_layer_out:  10.095709800720215 , sf_layer_out:  0.0003081060152201976
    bw_layer_in:  16
    th_layer_in:  8.57522201538086
    bw_layer_out:  16
    th_layer_out:  10.095709800720215
    --------------------------------------------------------------------------------
    Processing layer 116 of 139
    Layer Name:res5a_branch2b_relu Type:ReLU
    Inputs: ['res5a_branch2b'], Outputs: ['res5a_branch2b']
    n:  32768 , len(bin_edges):  449
    Mean : th_layer_out:  9.204764366149902 , sf_layer_out:  0.0002809156885326671
    bw_layer_out:  16
    th_layer_out:  9.204764366149902
    --------------------------------------------------------------------------------
    Processing layer 117 of 139
    Layer Name:res5a_branch2c Type:Convolution
    Inputs: ['res5a_branch2b'], Outputs: ['res5a_branch2c']
    Quantizing conv input layer ... res5a_branch2c
    Threshold in shape= ()
    Quantizing conv weights for layer res5a_branch2c...
    Threshold params shape= (2048,)
    n:  32768 , len(bin_edges):  898
    Mean : th_layer_out:  23.040061950683594 , sf_layer_out:  0.0007031483489694996
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  898
    Mean : th_layer_out:  23.040061950683594 , sf_layer_out:  0.0007031483489694996
    bw_layer_in:  16
    th_layer_in:  9.204764366149902
    bw_layer_out:  16
    th_layer_out:  23.040061950683594
    --------------------------------------------------------------------------------
    Processing layer 118 of 139
    Layer Name:res5a Type:Eltwise
    Inputs: ['res5a_branch1', 'res5a_branch2c'], Outputs: ['res5a']
    bw_layer_in:  16
    th_layer_in:  40.536643981933594
    bw_layer_out:  16
    th_layer_out:  40.536643981933594
    --------------------------------------------------------------------------------
    Processing layer 119 of 139
    Layer Name:res5a_relu Type:ReLU
    Inputs: ['res5a'], Outputs: ['res5a']
    n:  32768 , len(bin_edges):  897
    Mean : th_layer_out:  51.18451690673828 , sf_layer_out:  0.0015620751642426308
    bw_layer_out:  16
    th_layer_out:  51.18451690673828
    --------------------------------------------------------------------------------
    Processing layer 120 of 139
    Layer Name:res5a_res5a_relu_0_split Type:Split
    Inputs: ['res5a'], Outputs: ['res5a_res5a_relu_0_split_0', 'res5a_res5a_relu_0_split_1']
    bw_layer_in:  16
    th_layer_in:  51.18451690673828
    bw_layer_out:  16
    th_layer_out:  51.18451690673828
    --------------------------------------------------------------------------------
    Processing layer 121 of 139
    Layer Name:res5b_branch2a Type:Convolution
    Inputs: ['res5a_res5a_relu_0_split_0'], Outputs: ['res5b_branch2a']
    Quantizing conv input layer ... res5b_branch2a
    Threshold in shape= ()
    Quantizing conv weights for layer res5b_branch2a...
    Threshold params shape= (512,)
    n:  32768 , len(bin_edges):  450
    Mean : th_layer_out:  12.868453979492188 , sf_layer_out:  0.0003927260347145661
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  450
    Mean : th_layer_out:  12.868453979492188 , sf_layer_out:  0.0003927260347145661
    bw_layer_in:  16
    th_layer_in:  51.18451690673828
    bw_layer_out:  16
    th_layer_out:  12.868453979492188
    --------------------------------------------------------------------------------
    Processing layer 122 of 139
    Layer Name:res5b_branch2a_relu Type:ReLU
    Inputs: ['res5b_branch2a'], Outputs: ['res5b_branch2a']
    n:  32768 , len(bin_edges):  449
    Mean : th_layer_out:  8.420501708984375 , sf_layer_out:  0.0002569811611982902
    bw_layer_out:  16
    th_layer_out:  8.420501708984375
    --------------------------------------------------------------------------------
    Processing layer 123 of 139
    Layer Name:res5b_branch2b Type:Convolution
    Inputs: ['res5b_branch2a'], Outputs: ['res5b_branch2b']
    Quantizing conv input layer ... res5b_branch2b
    Threshold in shape= ()
    Quantizing conv weights for layer res5b_branch2b...
    Threshold params shape= (512,)
    n:  32768 , len(bin_edges):  450
    Mean : th_layer_out:  10.661190032958984 , sf_layer_out:  0.0003253636290462656
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  450
    Mean : th_layer_out:  10.661190032958984 , sf_layer_out:  0.0003253636290462656
    bw_layer_in:  16
    th_layer_in:  8.420501708984375
    bw_layer_out:  16
    th_layer_out:  10.661190032958984
    --------------------------------------------------------------------------------
    Processing layer 124 of 139
    Layer Name:res5b_branch2b_relu Type:ReLU
    Inputs: ['res5b_branch2b'], Outputs: ['res5b_branch2b']
    n:  32768 , len(bin_edges):  449
    Mean : th_layer_out:  5.642468452453613 , sf_layer_out:  0.00017219972693422082
    bw_layer_out:  16
    th_layer_out:  5.642468452453613
    --------------------------------------------------------------------------------
    Processing layer 125 of 139
    Layer Name:res5b_branch2c Type:Convolution
    Inputs: ['res5b_branch2b'], Outputs: ['res5b_branch2c']
    Quantizing conv input layer ... res5b_branch2c
    Threshold in shape= ()
    Quantizing conv weights for layer res5b_branch2c...
    Threshold params shape= (2048,)
    n:  32768 , len(bin_edges):  898
    Mean : th_layer_out:  25.313888549804688 , sf_layer_out:  0.0007725421475815512
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  898
    Mean : th_layer_out:  25.313888549804688 , sf_layer_out:  0.0007725421475815512
    bw_layer_in:  16
    th_layer_in:  5.642468452453613
    bw_layer_out:  16
    th_layer_out:  25.313888549804688
    --------------------------------------------------------------------------------
    Processing layer 126 of 139
    Layer Name:res5b Type:Eltwise
    Inputs: ['res5a_res5a_relu_0_split_1', 'res5b_branch2c'], Outputs: ['res5b']
    bw_layer_in:  16
    th_layer_in:  51.18451690673828
    bw_layer_out:  16
    th_layer_out:  51.18451690673828
    --------------------------------------------------------------------------------
    Processing layer 127 of 139
    Layer Name:res5b_relu Type:ReLU
    Inputs: ['res5b'], Outputs: ['res5b']
    n:  32768 , len(bin_edges):  897
    Mean : th_layer_out:  53.91033935546875 , sf_layer_out:  0.0016452632024740975
    bw_layer_out:  16
    th_layer_out:  53.91033935546875
    --------------------------------------------------------------------------------
    Processing layer 128 of 139
    Layer Name:res5b_res5b_relu_0_split Type:Split
    Inputs: ['res5b'], Outputs: ['res5b_res5b_relu_0_split_0', 'res5b_res5b_relu_0_split_1']
    bw_layer_in:  16
    th_layer_in:  53.91033935546875
    bw_layer_out:  16
    th_layer_out:  53.91033935546875
    --------------------------------------------------------------------------------
    Processing layer 129 of 139
    Layer Name:res5c_branch2a Type:Convolution
    Inputs: ['res5b_res5b_relu_0_split_0'], Outputs: ['res5c_branch2a']
    Quantizing conv input layer ... res5c_branch2a
    Threshold in shape= ()
    Quantizing conv weights for layer res5c_branch2a...
    Threshold params shape= (512,)
    n:  32768 , len(bin_edges):  450
    Mean : th_layer_out:  7.657388210296631 , sf_layer_out:  0.00023369207465732692
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  450
    Mean : th_layer_out:  7.657388210296631 , sf_layer_out:  0.00023369207465732692
    bw_layer_in:  16
    th_layer_in:  53.91033935546875
    bw_layer_out:  16
    th_layer_out:  7.657388210296631
    --------------------------------------------------------------------------------
    Processing layer 130 of 139
    Layer Name:res5c_branch2a_relu Type:ReLU
    Inputs: ['res5c_branch2a'], Outputs: ['res5c_branch2a']
    n:  32768 , len(bin_edges):  449
    Mean : th_layer_out:  7.657388210296631 , sf_layer_out:  0.00023369207465732692
    bw_layer_out:  16
    th_layer_out:  7.657388210296631
    --------------------------------------------------------------------------------
    Processing layer 131 of 139
    Layer Name:res5c_branch2b Type:Convolution
    Inputs: ['res5c_branch2a'], Outputs: ['res5c_branch2b']
    Quantizing conv input layer ... res5c_branch2b
    Threshold in shape= ()
    Quantizing conv weights for layer res5c_branch2b...
    Threshold params shape= (512,)
    n:  32768 , len(bin_edges):  450
    Mean : th_layer_out:  9.678520202636719 , sf_layer_out:  0.000295374010517799
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  450
    Mean : th_layer_out:  9.678520202636719 , sf_layer_out:  0.000295374010517799
    bw_layer_in:  16
    th_layer_in:  7.657388210296631
    bw_layer_out:  16
    th_layer_out:  9.678520202636719
    --------------------------------------------------------------------------------
    Processing layer 132 of 139
    Layer Name:res5c_branch2b_relu Type:ReLU
    Inputs: ['res5c_branch2b'], Outputs: ['res5c_branch2b']
    n:  32768 , len(bin_edges):  449
    Mean : th_layer_out:  8.236367225646973 , sf_layer_out:  0.0002513616512236998
    bw_layer_out:  16
    th_layer_out:  8.236367225646973
    --------------------------------------------------------------------------------
    Processing layer 133 of 139
    Layer Name:res5c_branch2c Type:Convolution
    Inputs: ['res5c_branch2b'], Outputs: ['res5c_branch2c']
    Quantizing conv input layer ... res5c_branch2c
    Threshold in shape= ()
    Quantizing conv weights for layer res5c_branch2c...
    Threshold params shape= (2048,)
    n:  32768 , len(bin_edges):  898
    Mean : th_layer_out:  29.749752044677734 , sf_layer_out:  0.0009079180896840643
    Threshold out shape= ()
    n:  32768 , len(bin_edges):  898
    Mean : th_layer_out:  29.749752044677734 , sf_layer_out:  0.0009079180896840643
    bw_layer_in:  16
    th_layer_in:  8.236367225646973
    bw_layer_out:  16
    th_layer_out:  29.749752044677734
    --------------------------------------------------------------------------------
    Processing layer 134 of 139
    Layer Name:res5c Type:Eltwise
    Inputs: ['res5b_res5b_relu_0_split_1', 'res5c_branch2c'], Outputs: ['res5c']
    bw_layer_in:  16
    th_layer_in:  53.91033935546875
    bw_layer_out:  16
    th_layer_out:  53.91033935546875
    --------------------------------------------------------------------------------
    Processing layer 135 of 139
    Layer Name:res5c_relu Type:ReLU
    Inputs: ['res5c'], Outputs: ['res5c']
    n:  32768 , len(bin_edges):  898
    Mean : th_layer_out:  57.24199676513672 , sf_layer_out:  0.0017469404207018256
    bw_layer_out:  16
    th_layer_out:  57.24199676513672
    --------------------------------------------------------------------------------
    Processing layer 136 of 139
    Layer Name:pool5 Type:Pooling
    Inputs: ['res5c'], Outputs: ['pool5']
    bw_layer_in:  16
    th_layer_in:  57.24199676513672
    bw_layer_out:  16
    th_layer_out:  57.24199676513672
    --------------------------------------------------------------------------------
    Processing layer 137 of 139
    Layer Name:fc1000 Type:InnerProduct
    Inputs: ['pool5'], Outputs: ['fc1000']
    n:  32768 , len(bin_edges):  91
    Mean : th_layer_out:  30.40081787109375 , sf_layer_out:  0.0009277876482770394
    bw_layer_in:  16
    th_layer_in:  57.24199676513672
    bw_layer_out:  16
    th_layer_out:  30.40081787109375
    --------------------------------------------------------------------------------
    Processing layer 138 of 139
    Layer Name:prob Type:Softmax
    Inputs: ['fc1000'], Outputs: ['prob']
    Passing
    Writing output files to work/quantization_params.json...
    Arguments:
    [('calibration_seed', None), ('mean_value', [104.007, 116.669, 122.679]), ('dims', [3, 224, 224]), ('calibration_indices', None), ('bitwidths', [16, 16, 16]), ('transpose', [2, 0, 1]), ('raw_scale', 255.0), ('calibration_size', 8), ('calibration_directory', '../xfdnn/tools/quantize/calibration_directory'), ('weights', 'work/optimized_model.caffemodel'), ('deploy_model', 'work/optimized_model.prototxt'), ('channel_swap', [2, 1, 0]), ('input_scale', 1.0), ('output_json', 'work/quantization_params.json')]
    **********
    Successfully produced quantization JSON file for 53 layers.
    


2. Try it yourself by changing the quantization precision
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

| Now that you have had a chance to see how this works, it's time to get
  some hands on experience.
| Change the following from the example above: 1. Precision of
  quantization by adjusting ``bitwidth``

Below, replace ``value`` with one of the supported precision types.
[8,8,8] or [16,16,16]

.. code:: ipython2

    # Since we already have an instance of the quantizer, you can just update these params:
    
    quantizer.bitwidths = [8,8,8]
    
    # Invoke quantizer
    try:
        quantizer.quantize()
    
        import json
        data = json.loads(open(config["quantizecfg"]).read())
        print("**********\nSuccessfully produced quantization JSON file for %d layers.\n"%len(data['network']))
    except Exception as e:
        print("Failed to quantize:",e)


.. parsed-literal::

    Mean : [104.007 116.669 122.679]
    Adding ../xfdnn/tools/quantize/calibration_directory/13923040300_b4c8521b4d_z.jpg to calibration batch.
    Adding ../xfdnn/tools/quantize/calibration_directory/15439525724_97d7cc2c81_z.jpg to calibration batch.
    Adding ../xfdnn/tools/quantize/calibration_directory/3272651417_27976a64b3_z.jpg to calibration batch.
    Adding ../xfdnn/tools/quantize/calibration_directory/3591612840_33710806df_z.jpg to calibration batch.
    Adding ../xfdnn/tools/quantize/calibration_directory/4788821373_441cd29c9f_z.jpg to calibration batch.
    Adding ../xfdnn/tools/quantize/calibration_directory/5904386289_924b24d75d_z.jpg to calibration batch.
    Adding ../xfdnn/tools/quantize/calibration_directory/7291910830_86a8ebb15d_z.jpg to calibration batch.
    Adding ../xfdnn/tools/quantize/calibration_directory/7647574936_ffebfa2bea_z.jpg to calibration batch.
    --------------------------------------------------------------------------------
    Processing layer 0 of 139
    Layer Name:data Type:Input
    Inputs: [], Outputs: ['data']
    Quantizing layer output...
    n:  128 , len(bin_edges):  1099
    Mean : th_layer_out:  151.06175441081842 , sf_layer_out:  1.1894626331560505
    bw_layer_out:  8
    th_layer_out:  151.06175441081842
    --------------------------------------------------------------------------------
    Processing layer 1 of 139
    Layer Name:conv1 Type:Convolution
    Inputs: ['data'], Outputs: ['conv1']
    Quantizing conv input layer ... conv1
    Threshold in shape= ()
    Quantizing conv weights for layer conv1...
    Threshold params shape= (64,)
    n:  128 , len(bin_edges):  2536
    Mean : th_layer_out:  11.652441256145048 , sf_layer_out:  0.09175150595389801
    Threshold out shape= ()
    n:  128 , len(bin_edges):  2536
    Mean : th_layer_out:  11.652441256145048 , sf_layer_out:  0.09175150595389801
    bw_layer_in:  8
    th_layer_in:  151.06175441081842
    bw_layer_out:  8
    th_layer_out:  11.652441256145048
    --------------------------------------------------------------------------------
    Processing layer 2 of 139
    Layer Name:conv1_relu Type:ReLU
    Inputs: ['conv1'], Outputs: ['conv1']
    n:  128 , len(bin_edges):  2536
    Mean : th_layer_out:  12.811102081614838 , sf_layer_out:  0.10087481954027432
    bw_layer_out:  8
    th_layer_out:  12.811102081614838
    --------------------------------------------------------------------------------
    Processing layer 3 of 139
    Layer Name:pool1 Type:Pooling
    Inputs: ['conv1'], Outputs: ['pool1']
    bw_layer_in:  8
    th_layer_in:  12.811102081614838
    bw_layer_out:  8
    th_layer_out:  12.811102081614838
    --------------------------------------------------------------------------------
    Processing layer 4 of 139
    Layer Name:pool1_pool1_0_split Type:Split
    Inputs: ['pool1'], Outputs: ['pool1_pool1_0_split_0', 'pool1_pool1_0_split_1']
    bw_layer_in:  8
    th_layer_in:  12.811102081614838
    bw_layer_out:  8
    th_layer_out:  12.811102081614838
    --------------------------------------------------------------------------------
    Processing layer 5 of 139
    Layer Name:res2a_branch1 Type:Convolution
    Inputs: ['pool1_pool1_0_split_0'], Outputs: ['res2a_branch1']
    Quantizing conv input layer ... res2a_branch1
    Threshold in shape= ()
    Quantizing conv weights for layer res2a_branch1...
    Threshold params shape= (256,)
    n:  128 , len(bin_edges):  2536
    Mean : th_layer_out:  12.521482332970734 , sf_layer_out:  0.09859434907850972
    Threshold out shape= ()
    n:  128 , len(bin_edges):  2536
    Mean : th_layer_out:  12.521482332970734 , sf_layer_out:  0.09859434907850972
    bw_layer_in:  8
    th_layer_in:  12.811102081614838
    bw_layer_out:  8
    th_layer_out:  12.521482332970734
    --------------------------------------------------------------------------------
    Processing layer 6 of 139
    Layer Name:res2a_branch2a Type:Convolution
    Inputs: ['pool1_pool1_0_split_1'], Outputs: ['res2a_branch2a']
    Quantizing conv input layer ... res2a_branch2a
    Threshold in shape= ()
    Quantizing conv weights for layer res2a_branch2a...
    Threshold params shape= (64,)
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  12.670744830501567 , sf_layer_out:  0.09976964433465801
    Threshold out shape= ()
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  12.670744830501567 , sf_layer_out:  0.09976964433465801
    bw_layer_in:  8
    th_layer_in:  12.811102081614838
    bw_layer_out:  8
    th_layer_out:  12.670744830501567
    --------------------------------------------------------------------------------
    Processing layer 7 of 139
    Layer Name:res2a_branch2a_relu Type:ReLU
    Inputs: ['res2a_branch2a'], Outputs: ['res2a_branch2a']
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  7.312464376353315 , sf_layer_out:  0.05757845965632531
    bw_layer_out:  8
    th_layer_out:  7.312464376353315
    --------------------------------------------------------------------------------
    Processing layer 8 of 139
    Layer Name:res2a_branch2b Type:Convolution
    Inputs: ['res2a_branch2a'], Outputs: ['res2a_branch2b']
    Quantizing conv input layer ... res2a_branch2b
    Threshold in shape= ()
    Quantizing conv weights for layer res2a_branch2b...
    Threshold params shape= (64,)
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  11.068771505581466 , sf_layer_out:  0.08715568114631075
    Threshold out shape= ()
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  11.068771505581466 , sf_layer_out:  0.08715568114631075
    bw_layer_in:  8
    th_layer_in:  7.312464376353315
    bw_layer_out:  8
    th_layer_out:  11.068771505581466
    --------------------------------------------------------------------------------
    Processing layer 9 of 139
    Layer Name:res2a_branch2b_relu Type:ReLU
    Inputs: ['res2a_branch2b'], Outputs: ['res2a_branch2b']
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  11.299671563064262 , sf_layer_out:  0.08897379183515167
    bw_layer_out:  8
    th_layer_out:  11.299671563064262
    --------------------------------------------------------------------------------
    Processing layer 10 of 139
    Layer Name:res2a_branch2c Type:Convolution
    Inputs: ['res2a_branch2b'], Outputs: ['res2a_branch2c']
    Quantizing conv input layer ... res2a_branch2c
    Threshold in shape= ()
    Quantizing conv weights for layer res2a_branch2c...
    Threshold params shape= (256,)
    n:  128 , len(bin_edges):  2536
    Mean : th_layer_out:  6.665226723221397 , sf_layer_out:  0.052482100182845645
    Threshold out shape= ()
    n:  128 , len(bin_edges):  2536
    Mean : th_layer_out:  6.665226723221397 , sf_layer_out:  0.052482100182845645
    bw_layer_in:  8
    th_layer_in:  11.299671563064262
    bw_layer_out:  8
    th_layer_out:  6.665226723221397
    --------------------------------------------------------------------------------
    Processing layer 11 of 139
    Layer Name:res2a Type:Eltwise
    Inputs: ['res2a_branch1', 'res2a_branch2c'], Outputs: ['res2a']
    bw_layer_in:  8
    th_layer_in:  12.521482332970734
    bw_layer_out:  8
    th_layer_out:  12.521482332970734
    --------------------------------------------------------------------------------
    Processing layer 12 of 139
    Layer Name:res2a_relu Type:ReLU
    Inputs: ['res2a'], Outputs: ['res2a']
    n:  128 , len(bin_edges):  2536
    Mean : th_layer_out:  4.963165791453224 , sf_layer_out:  0.039080045601993886
    bw_layer_out:  8
    th_layer_out:  4.963165791453224
    --------------------------------------------------------------------------------
    Processing layer 13 of 139
    Layer Name:res2a_res2a_relu_0_split Type:Split
    Inputs: ['res2a'], Outputs: ['res2a_res2a_relu_0_split_0', 'res2a_res2a_relu_0_split_1']
    bw_layer_in:  8
    th_layer_in:  4.963165791453224
    bw_layer_out:  8
    th_layer_out:  4.963165791453224
    --------------------------------------------------------------------------------
    Processing layer 14 of 139
    Layer Name:res2b_branch2a Type:Convolution
    Inputs: ['res2a_res2a_relu_0_split_0'], Outputs: ['res2b_branch2a']
    Quantizing conv input layer ... res2b_branch2a
    Threshold in shape= ()
    Quantizing conv weights for layer res2b_branch2a...
    Threshold params shape= (64,)
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  9.461163010506977 , sf_layer_out:  0.07449734653942502
    Threshold out shape= ()
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  9.461163010506977 , sf_layer_out:  0.07449734653942502
    bw_layer_in:  8
    th_layer_in:  4.963165791453224
    bw_layer_out:  8
    th_layer_out:  9.461163010506977
    --------------------------------------------------------------------------------
    Processing layer 15 of 139
    Layer Name:res2b_branch2a_relu Type:ReLU
    Inputs: ['res2b_branch2a'], Outputs: ['res2b_branch2a']
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  6.281652632195867 , sf_layer_out:  0.049461831749573755
    bw_layer_out:  8
    th_layer_out:  6.281652632195867
    --------------------------------------------------------------------------------
    Processing layer 16 of 139
    Layer Name:res2b_branch2b Type:Convolution
    Inputs: ['res2b_branch2a'], Outputs: ['res2b_branch2b']
    Quantizing conv input layer ... res2b_branch2b
    Threshold in shape= ()
    Quantizing conv weights for layer res2b_branch2b...
    Threshold params shape= (64,)
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  7.8268757569677065 , sf_layer_out:  0.06162894296824966
    Threshold out shape= ()
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  7.8268757569677065 , sf_layer_out:  0.06162894296824966
    bw_layer_in:  8
    th_layer_in:  6.281652632195867
    bw_layer_out:  8
    th_layer_out:  7.8268757569677065
    --------------------------------------------------------------------------------
    Processing layer 17 of 139
    Layer Name:res2b_branch2b_relu Type:ReLU
    Inputs: ['res2b_branch2b'], Outputs: ['res2b_branch2b']
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  6.8760890689934095 , sf_layer_out:  0.054142433614121334
    bw_layer_out:  8
    th_layer_out:  6.8760890689934095
    --------------------------------------------------------------------------------
    Processing layer 18 of 139
    Layer Name:res2b_branch2c Type:Convolution
    Inputs: ['res2b_branch2b'], Outputs: ['res2b_branch2c']
    Quantizing conv input layer ... res2b_branch2c
    Threshold in shape= ()
    Quantizing conv weights for layer res2b_branch2c...
    Threshold params shape= (256,)
    n:  128 , len(bin_edges):  2536
    Mean : th_layer_out:  4.823116758636234 , sf_layer_out:  0.03797729731209633
    Threshold out shape= ()
    n:  128 , len(bin_edges):  2536
    Mean : th_layer_out:  4.823116758636234 , sf_layer_out:  0.03797729731209633
    bw_layer_in:  8
    th_layer_in:  6.8760890689934095
    bw_layer_out:  8
    th_layer_out:  4.823116758636234
    --------------------------------------------------------------------------------
    Processing layer 19 of 139
    Layer Name:res2b Type:Eltwise
    Inputs: ['res2a_res2a_relu_0_split_1', 'res2b_branch2c'], Outputs: ['res2b']
    bw_layer_in:  8
    th_layer_in:  4.963165791453224
    bw_layer_out:  8
    th_layer_out:  4.963165791453224
    --------------------------------------------------------------------------------
    Processing layer 20 of 139
    Layer Name:res2b_relu Type:ReLU
    Inputs: ['res2b'], Outputs: ['res2b']
    n:  128 , len(bin_edges):  2536
    Mean : th_layer_out:  7.278369813275761 , sf_layer_out:  0.0573099985297304
    bw_layer_out:  8
    th_layer_out:  7.278369813275761
    --------------------------------------------------------------------------------
    Processing layer 21 of 139
    Layer Name:res2b_res2b_relu_0_split Type:Split
    Inputs: ['res2b'], Outputs: ['res2b_res2b_relu_0_split_0', 'res2b_res2b_relu_0_split_1']
    bw_layer_in:  8
    th_layer_in:  7.278369813275761
    bw_layer_out:  8
    th_layer_out:  7.278369813275761
    --------------------------------------------------------------------------------
    Processing layer 22 of 139
    Layer Name:res2c_branch2a Type:Convolution
    Inputs: ['res2b_res2b_relu_0_split_0'], Outputs: ['res2c_branch2a']
    Quantizing conv input layer ... res2c_branch2a
    Threshold in shape= ()
    Quantizing conv weights for layer res2c_branch2a...
    Threshold params shape= (64,)
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  7.454529793856647 , sf_layer_out:  0.05869708499099722
    Threshold out shape= ()
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  7.454529793856647 , sf_layer_out:  0.05869708499099722
    bw_layer_in:  8
    th_layer_in:  7.278369813275761
    bw_layer_out:  8
    th_layer_out:  7.454529793856647
    --------------------------------------------------------------------------------
    Processing layer 23 of 139
    Layer Name:res2c_branch2a_relu Type:ReLU
    Inputs: ['res2c_branch2a'], Outputs: ['res2c_branch2a']
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  5.929356404283445 , sf_layer_out:  0.04668784570301925
    bw_layer_out:  8
    th_layer_out:  5.929356404283445
    --------------------------------------------------------------------------------
    Processing layer 24 of 139
    Layer Name:res2c_branch2b Type:Convolution
    Inputs: ['res2c_branch2a'], Outputs: ['res2c_branch2b']
    Quantizing conv input layer ... res2c_branch2b
    Threshold in shape= ()
    Quantizing conv weights for layer res2c_branch2b...
    Threshold params shape= (64,)
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  8.386320207397269 , sf_layer_out:  0.06603401738108086
    Threshold out shape= ()
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  8.386320207397269 , sf_layer_out:  0.06603401738108086
    bw_layer_in:  8
    th_layer_in:  5.929356404283445
    bw_layer_out:  8
    th_layer_out:  8.386320207397269
    --------------------------------------------------------------------------------
    Processing layer 25 of 139
    Layer Name:res2c_branch2b_relu Type:ReLU
    Inputs: ['res2c_branch2b'], Outputs: ['res2c_branch2b']
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  8.440107402741345 , sf_layer_out:  0.06645753860426257
    bw_layer_out:  8
    th_layer_out:  8.440107402741345
    --------------------------------------------------------------------------------
    Processing layer 26 of 139
    Layer Name:res2c_branch2c Type:Convolution
    Inputs: ['res2c_branch2b'], Outputs: ['res2c_branch2c']
    Quantizing conv input layer ... res2c_branch2c
    Threshold in shape= ()
    Quantizing conv weights for layer res2c_branch2c...
    Threshold params shape= (256,)
    n:  128 , len(bin_edges):  2536
    Mean : th_layer_out:  5.4526435035690515 , sf_layer_out:  0.04293420081550434
    Threshold out shape= ()
    n:  128 , len(bin_edges):  2536
    Mean : th_layer_out:  5.4526435035690515 , sf_layer_out:  0.04293420081550434
    bw_layer_in:  8
    th_layer_in:  8.440107402741345
    bw_layer_out:  8
    th_layer_out:  5.4526435035690515
    --------------------------------------------------------------------------------
    Processing layer 27 of 139
    Layer Name:res2c Type:Eltwise
    Inputs: ['res2b_res2b_relu_0_split_1', 'res2c_branch2c'], Outputs: ['res2c']
    bw_layer_in:  8
    th_layer_in:  7.278369813275761
    bw_layer_out:  8
    th_layer_out:  7.278369813275761
    --------------------------------------------------------------------------------
    Processing layer 28 of 139
    Layer Name:res2c_relu Type:ReLU
    Inputs: ['res2c'], Outputs: ['res2c']
    n:  128 , len(bin_edges):  2536
    Mean : th_layer_out:  10.757935019498746 , sf_layer_out:  0.08470814975983264
    bw_layer_out:  8
    th_layer_out:  10.757935019498746
    --------------------------------------------------------------------------------
    Processing layer 29 of 139
    Layer Name:res2c_res2c_relu_0_split Type:Split
    Inputs: ['res2c'], Outputs: ['res2c_res2c_relu_0_split_0', 'res2c_res2c_relu_0_split_1']
    bw_layer_in:  8
    th_layer_in:  10.757935019498746
    bw_layer_out:  8
    th_layer_out:  10.757935019498746
    --------------------------------------------------------------------------------
    Processing layer 30 of 139
    Layer Name:res3a_branch1 Type:Convolution
    Inputs: ['res2c_res2c_relu_0_split_0'], Outputs: ['res3a_branch1']
    Quantizing conv input layer ... res3a_branch1
    Threshold in shape= ()
    Quantizing conv weights for layer res3a_branch1...
    Threshold params shape= (512,)
    n:  128 , len(bin_edges):  1794
    Mean : th_layer_out:  7.668101090528549 , sf_layer_out:  0.06037874874431928
    Threshold out shape= ()
    n:  128 , len(bin_edges):  1794
    Mean : th_layer_out:  7.668101090528549 , sf_layer_out:  0.06037874874431928
    bw_layer_in:  8
    th_layer_in:  10.757935019498746
    bw_layer_out:  8
    th_layer_out:  7.668101090528549
    --------------------------------------------------------------------------------
    Processing layer 31 of 139
    Layer Name:res3a_branch2a Type:Convolution
    Inputs: ['res2c_res2c_relu_0_split_1'], Outputs: ['res3a_branch2a']
    Quantizing conv input layer ... res3a_branch2a
    Threshold in shape= ()
    Quantizing conv weights for layer res3a_branch2a...
    Threshold params shape= (128,)
    n:  128 , len(bin_edges):  898
    Mean : th_layer_out:  6.211613093730199 , sf_layer_out:  0.04891033932071023
    Threshold out shape= ()
    n:  128 , len(bin_edges):  898
    Mean : th_layer_out:  6.211613093730199 , sf_layer_out:  0.04891033932071023
    bw_layer_in:  8
    th_layer_in:  10.757935019498746
    bw_layer_out:  8
    th_layer_out:  6.211613093730199
    --------------------------------------------------------------------------------
    Processing layer 32 of 139
    Layer Name:res3a_branch2a_relu Type:ReLU
    Inputs: ['res3a_branch2a'], Outputs: ['res3a_branch2a']
    n:  128 , len(bin_edges):  897
    Mean : th_layer_out:  5.897329454975469 , sf_layer_out:  0.04643566499980684
    bw_layer_out:  8
    th_layer_out:  5.897329454975469
    --------------------------------------------------------------------------------
    Processing layer 33 of 139
    Layer Name:res3a_branch2b Type:Convolution
    Inputs: ['res3a_branch2a'], Outputs: ['res3a_branch2b']
    Quantizing conv input layer ... res3a_branch2b
    Threshold in shape= ()
    Quantizing conv weights for layer res3a_branch2b...
    Threshold params shape= (128,)
    n:  128 , len(bin_edges):  897
    Mean : th_layer_out:  7.024244919419289 , sf_layer_out:  0.0553090151135377
    Threshold out shape= ()
    n:  128 , len(bin_edges):  897
    Mean : th_layer_out:  7.024244919419289 , sf_layer_out:  0.0553090151135377
    bw_layer_in:  8
    th_layer_in:  5.897329454975469
    bw_layer_out:  8
    th_layer_out:  7.024244919419289
    --------------------------------------------------------------------------------
    Processing layer 34 of 139
    Layer Name:res3a_branch2b_relu Type:ReLU
    Inputs: ['res3a_branch2b'], Outputs: ['res3a_branch2b']
    n:  128 , len(bin_edges):  897
    Mean : th_layer_out:  5.420651918809329 , sf_layer_out:  0.04268229857330181
    bw_layer_out:  8
    th_layer_out:  5.420651918809329
    --------------------------------------------------------------------------------
    Processing layer 35 of 139
    Layer Name:res3a_branch2c Type:Convolution
    Inputs: ['res3a_branch2b'], Outputs: ['res3a_branch2c']
    Quantizing conv input layer ... res3a_branch2c
    Threshold in shape= ()
    Quantizing conv weights for layer res3a_branch2c...
    Threshold params shape= (512,)
    n:  128 , len(bin_edges):  1793
    Mean : th_layer_out:  7.738515824611698 , sf_layer_out:  0.060933195469383444
    Threshold out shape= ()
    n:  128 , len(bin_edges):  1793
    Mean : th_layer_out:  7.738515824611698 , sf_layer_out:  0.060933195469383444
    bw_layer_in:  8
    th_layer_in:  5.420651918809329
    bw_layer_out:  8
    th_layer_out:  7.738515824611698
    --------------------------------------------------------------------------------
    Processing layer 36 of 139
    Layer Name:res3a Type:Eltwise
    Inputs: ['res3a_branch1', 'res3a_branch2c'], Outputs: ['res3a']
    bw_layer_in:  8
    th_layer_in:  7.738515824611698
    bw_layer_out:  8
    th_layer_out:  7.738515824611698
    --------------------------------------------------------------------------------
    Processing layer 37 of 139
    Layer Name:res3a_relu Type:ReLU
    Inputs: ['res3a'], Outputs: ['res3a']
    n:  128 , len(bin_edges):  1793
    Mean : th_layer_out:  11.47899916395545 , sf_layer_out:  0.09038582018862559
    bw_layer_out:  8
    th_layer_out:  11.47899916395545
    --------------------------------------------------------------------------------
    Processing layer 38 of 139
    Layer Name:res3a_res3a_relu_0_split Type:Split
    Inputs: ['res3a'], Outputs: ['res3a_res3a_relu_0_split_0', 'res3a_res3a_relu_0_split_1']
    bw_layer_in:  8
    th_layer_in:  11.47899916395545
    bw_layer_out:  8
    th_layer_out:  11.47899916395545
    --------------------------------------------------------------------------------
    Processing layer 39 of 139
    Layer Name:res3b_branch2a Type:Convolution
    Inputs: ['res3a_res3a_relu_0_split_0'], Outputs: ['res3b_branch2a']
    Quantizing conv input layer ... res3b_branch2a
    Threshold in shape= ()
    Quantizing conv weights for layer res3b_branch2a...
    Threshold params shape= (128,)
    n:  128 , len(bin_edges):  898
    Mean : th_layer_out:  5.584425430234061 , sf_layer_out:  0.043971853781370564
    Threshold out shape= ()
    n:  128 , len(bin_edges):  898
    Mean : th_layer_out:  5.584425430234061 , sf_layer_out:  0.043971853781370564
    bw_layer_in:  8
    th_layer_in:  11.47899916395545
    bw_layer_out:  8
    th_layer_out:  5.584425430234061
    --------------------------------------------------------------------------------
    Processing layer 40 of 139
    Layer Name:res3b_branch2a_relu Type:ReLU
    Inputs: ['res3b_branch2a'], Outputs: ['res3b_branch2a']
    n:  128 , len(bin_edges):  897
    Mean : th_layer_out:  5.578988927815642 , sf_layer_out:  0.043929046675713714
    bw_layer_out:  8
    th_layer_out:  5.578988927815642
    --------------------------------------------------------------------------------
    Processing layer 41 of 139
    Layer Name:res3b_branch2b Type:Convolution
    Inputs: ['res3b_branch2a'], Outputs: ['res3b_branch2b']
    Quantizing conv input layer ... res3b_branch2b
    Threshold in shape= ()
    Quantizing conv weights for layer res3b_branch2b...
    Threshold params shape= (128,)
    n:  128 , len(bin_edges):  898
    Mean : th_layer_out:  8.06406443839355 , sf_layer_out:  0.06349657038105157
    Threshold out shape= ()
    n:  128 , len(bin_edges):  898
    Mean : th_layer_out:  8.06406443839355 , sf_layer_out:  0.06349657038105157
    bw_layer_in:  8
    th_layer_in:  5.578988927815642
    bw_layer_out:  8
    th_layer_out:  8.06406443839355
    --------------------------------------------------------------------------------
    Processing layer 42 of 139
    Layer Name:res3b_branch2b_relu Type:ReLU
    Inputs: ['res3b_branch2b'], Outputs: ['res3b_branch2b']
    n:  128 , len(bin_edges):  897
    Mean : th_layer_out:  6.084340050284352 , sf_layer_out:  0.04790818937231773
    bw_layer_out:  8
    th_layer_out:  6.084340050284352
    --------------------------------------------------------------------------------
    Processing layer 43 of 139
    Layer Name:res3b_branch2c Type:Convolution
    Inputs: ['res3b_branch2b'], Outputs: ['res3b_branch2c']
    Quantizing conv input layer ... res3b_branch2c
    Threshold in shape= ()
    Quantizing conv weights for layer res3b_branch2c...
    Threshold params shape= (512,)
    n:  128 , len(bin_edges):  1793
    Mean : th_layer_out:  4.191345164020147 , sf_layer_out:  0.03300271782693029
    Threshold out shape= ()
    n:  128 , len(bin_edges):  1793
    Mean : th_layer_out:  4.191345164020147 , sf_layer_out:  0.03300271782693029
    bw_layer_in:  8
    th_layer_in:  6.084340050284352
    bw_layer_out:  8
    th_layer_out:  4.191345164020147
    --------------------------------------------------------------------------------
    Processing layer 44 of 139
    Layer Name:res3b Type:Eltwise
    Inputs: ['res3a_res3a_relu_0_split_1', 'res3b_branch2c'], Outputs: ['res3b']
    bw_layer_in:  8
    th_layer_in:  11.47899916395545
    bw_layer_out:  8
    th_layer_out:  11.47899916395545
    --------------------------------------------------------------------------------
    Processing layer 45 of 139
    Layer Name:res3b_relu Type:ReLU
    Inputs: ['res3b'], Outputs: ['res3b']
    n:  128 , len(bin_edges):  1793
    Mean : th_layer_out:  6.0829607014145175 , sf_layer_out:  0.047897328357594623
    bw_layer_out:  8
    th_layer_out:  6.0829607014145175
    --------------------------------------------------------------------------------
    Processing layer 46 of 139
    Layer Name:res3b_res3b_relu_0_split Type:Split
    Inputs: ['res3b'], Outputs: ['res3b_res3b_relu_0_split_0', 'res3b_res3b_relu_0_split_1']
    bw_layer_in:  8
    th_layer_in:  6.0829607014145175
    bw_layer_out:  8
    th_layer_out:  6.0829607014145175
    --------------------------------------------------------------------------------
    Processing layer 47 of 139
    Layer Name:res3c_branch2a Type:Convolution
    Inputs: ['res3b_res3b_relu_0_split_0'], Outputs: ['res3c_branch2a']
    Quantizing conv input layer ... res3c_branch2a
    Threshold in shape= ()
    Quantizing conv weights for layer res3c_branch2a...
    Threshold params shape= (128,)
    n:  128 , len(bin_edges):  898
    Mean : th_layer_out:  5.702221017218752 , sf_layer_out:  0.04489937808833663
    Threshold out shape= ()
    n:  128 , len(bin_edges):  898
    Mean : th_layer_out:  5.702221017218752 , sf_layer_out:  0.04489937808833663
    bw_layer_in:  8
    th_layer_in:  6.0829607014145175
    bw_layer_out:  8
    th_layer_out:  5.702221017218752
    --------------------------------------------------------------------------------
    Processing layer 48 of 139
    Layer Name:res3c_branch2a_relu Type:ReLU
    Inputs: ['res3c_branch2a'], Outputs: ['res3c_branch2a']
    n:  128 , len(bin_edges):  897
    Mean : th_layer_out:  4.082945006766489 , sf_layer_out:  0.0321491732816259
    bw_layer_out:  8
    th_layer_out:  4.082945006766489
    --------------------------------------------------------------------------------
    Processing layer 49 of 139
    Layer Name:res3c_branch2b Type:Convolution
    Inputs: ['res3c_branch2a'], Outputs: ['res3c_branch2b']
    Quantizing conv input layer ... res3c_branch2b
    Threshold in shape= ()
    Quantizing conv weights for layer res3c_branch2b...
    Threshold params shape= (128,)
    n:  128 , len(bin_edges):  898
    Mean : th_layer_out:  7.256881294441861 , sf_layer_out:  0.0571407975940304
    Threshold out shape= ()
    n:  128 , len(bin_edges):  898
    Mean : th_layer_out:  7.256881294441861 , sf_layer_out:  0.0571407975940304
    bw_layer_in:  8
    th_layer_in:  4.082945006766489
    bw_layer_out:  8
    th_layer_out:  7.256881294441861
    --------------------------------------------------------------------------------
    Processing layer 50 of 139
    Layer Name:res3c_branch2b_relu Type:ReLU
    Inputs: ['res3c_branch2b'], Outputs: ['res3c_branch2b']
    n:  128 , len(bin_edges):  898
    Mean : th_layer_out:  5.8813841882490925 , sf_layer_out:  0.04631011171849679
    bw_layer_out:  8
    th_layer_out:  5.8813841882490925
    --------------------------------------------------------------------------------
    Processing layer 51 of 139
    Layer Name:res3c_branch2c Type:Convolution
    Inputs: ['res3c_branch2b'], Outputs: ['res3c_branch2c']
    Quantizing conv input layer ... res3c_branch2c
    Threshold in shape= ()
    Quantizing conv weights for layer res3c_branch2c...
    Threshold params shape= (512,)
    n:  128 , len(bin_edges):  1793
    Mean : th_layer_out:  6.919283195797886 , sf_layer_out:  0.05448254484880226
    Threshold out shape= ()
    n:  128 , len(bin_edges):  1793
    Mean : th_layer_out:  6.919283195797886 , sf_layer_out:  0.05448254484880226
    bw_layer_in:  8
    th_layer_in:  5.8813841882490925
    bw_layer_out:  8
    th_layer_out:  6.919283195797886
    --------------------------------------------------------------------------------
    Processing layer 52 of 139
    Layer Name:res3c Type:Eltwise
    Inputs: ['res3b_res3b_relu_0_split_1', 'res3c_branch2c'], Outputs: ['res3c']
    bw_layer_in:  8
    th_layer_in:  6.919283195797886
    bw_layer_out:  8
    th_layer_out:  6.919283195797886
    --------------------------------------------------------------------------------
    Processing layer 53 of 139
    Layer Name:res3c_relu Type:ReLU
    Inputs: ['res3c'], Outputs: ['res3c']
    n:  128 , len(bin_edges):  1793
    Mean : th_layer_out:  11.23407904191741 , sf_layer_out:  0.08845731529068826
    bw_layer_out:  8
    th_layer_out:  11.23407904191741
    --------------------------------------------------------------------------------
    Processing layer 54 of 139
    Layer Name:res3c_res3c_relu_0_split Type:Split
    Inputs: ['res3c'], Outputs: ['res3c_res3c_relu_0_split_0', 'res3c_res3c_relu_0_split_1']
    bw_layer_in:  8
    th_layer_in:  11.23407904191741
    bw_layer_out:  8
    th_layer_out:  11.23407904191741
    --------------------------------------------------------------------------------
    Processing layer 55 of 139
    Layer Name:res3d_branch2a Type:Convolution
    Inputs: ['res3c_res3c_relu_0_split_0'], Outputs: ['res3d_branch2a']
    Quantizing conv input layer ... res3d_branch2a
    Threshold in shape= ()
    Quantizing conv weights for layer res3d_branch2a...
    Threshold params shape= (128,)
    n:  128 , len(bin_edges):  898
    Mean : th_layer_out:  9.766306289728137 , sf_layer_out:  0.0769000495254184
    Threshold out shape= ()
    n:  128 , len(bin_edges):  898
    Mean : th_layer_out:  9.766306289728137 , sf_layer_out:  0.0769000495254184
    bw_layer_in:  8
    th_layer_in:  11.23407904191741
    bw_layer_out:  8
    th_layer_out:  9.766306289728137
    --------------------------------------------------------------------------------
    Processing layer 56 of 139
    Layer Name:res3d_branch2a_relu Type:ReLU
    Inputs: ['res3d_branch2a'], Outputs: ['res3d_branch2a']
    n:  128 , len(bin_edges):  897
    Mean : th_layer_out:  8.544990828526872 , sf_layer_out:  0.06728339235060529
    bw_layer_out:  8
    th_layer_out:  8.544990828526872
    --------------------------------------------------------------------------------
    Processing layer 57 of 139
    Layer Name:res3d_branch2b Type:Convolution
    Inputs: ['res3d_branch2a'], Outputs: ['res3d_branch2b']
    Quantizing conv input layer ... res3d_branch2b
    Threshold in shape= ()
    Quantizing conv weights for layer res3d_branch2b...
    Threshold params shape= (128,)
    n:  128 , len(bin_edges):  897
    Mean : th_layer_out:  7.437435177287885 , sf_layer_out:  0.058562481710928226
    Threshold out shape= ()
    n:  128 , len(bin_edges):  897
    Mean : th_layer_out:  7.437435177287885 , sf_layer_out:  0.058562481710928226
    bw_layer_in:  8
    th_layer_in:  8.544990828526872
    bw_layer_out:  8
    th_layer_out:  7.437435177287885
    --------------------------------------------------------------------------------
    Processing layer 58 of 139
    Layer Name:res3d_branch2b_relu Type:ReLU
    Inputs: ['res3d_branch2b'], Outputs: ['res3d_branch2b']
    n:  128 , len(bin_edges):  897
    Mean : th_layer_out:  7.944677133113146 , sf_layer_out:  0.06255651285915863
    bw_layer_out:  8
    th_layer_out:  7.944677133113146
    --------------------------------------------------------------------------------
    Processing layer 59 of 139
    Layer Name:res3d_branch2c Type:Convolution
    Inputs: ['res3d_branch2b'], Outputs: ['res3d_branch2c']
    Quantizing conv input layer ... res3d_branch2c
    Threshold in shape= ()
    Quantizing conv weights for layer res3d_branch2c...
    Threshold params shape= (512,)
    n:  128 , len(bin_edges):  1793
    Mean : th_layer_out:  3.5672137127923116 , sf_layer_out:  0.028088296951120563
    Threshold out shape= ()
    n:  128 , len(bin_edges):  1793
    Mean : th_layer_out:  3.5672137127923116 , sf_layer_out:  0.028088296951120563
    bw_layer_in:  8
    th_layer_in:  7.944677133113146
    bw_layer_out:  8
    th_layer_out:  3.5672137127923116
    --------------------------------------------------------------------------------
    Processing layer 60 of 139
    Layer Name:res3d Type:Eltwise
    Inputs: ['res3c_res3c_relu_0_split_1', 'res3d_branch2c'], Outputs: ['res3d']
    bw_layer_in:  8
    th_layer_in:  11.23407904191741
    bw_layer_out:  8
    th_layer_out:  11.23407904191741
    --------------------------------------------------------------------------------
    Processing layer 61 of 139
    Layer Name:res3d_relu Type:ReLU
    Inputs: ['res3d'], Outputs: ['res3d']
    n:  128 , len(bin_edges):  1793
    Mean : th_layer_out:  5.956504426896572 , sf_layer_out:  0.04690160966060293
    bw_layer_out:  8
    th_layer_out:  5.956504426896572
    --------------------------------------------------------------------------------
    Processing layer 62 of 139
    Layer Name:res3d_res3d_relu_0_split Type:Split
    Inputs: ['res3d'], Outputs: ['res3d_res3d_relu_0_split_0', 'res3d_res3d_relu_0_split_1']
    bw_layer_in:  8
    th_layer_in:  5.956504426896572
    bw_layer_out:  8
    th_layer_out:  5.956504426896572
    --------------------------------------------------------------------------------
    Processing layer 63 of 139
    Layer Name:res4a_branch1 Type:Convolution
    Inputs: ['res3d_res3d_relu_0_split_0'], Outputs: ['res4a_branch1']
    Quantizing conv input layer ... res4a_branch1
    Threshold in shape= ()
    Quantizing conv weights for layer res4a_branch1...
    Threshold params shape= (1024,)
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  7.918170494988138 , sf_layer_out:  0.062347799173134946
    Threshold out shape= ()
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  7.918170494988138 , sf_layer_out:  0.062347799173134946
    bw_layer_in:  8
    th_layer_in:  5.956504426896572
    bw_layer_out:  8
    th_layer_out:  7.918170494988138
    --------------------------------------------------------------------------------
    Processing layer 64 of 139
    Layer Name:res4a_branch2a Type:Convolution
    Inputs: ['res3d_res3d_relu_0_split_1'], Outputs: ['res4a_branch2a']
    Quantizing conv input layer ... res4a_branch2a
    Threshold in shape= ()
    Quantizing conv weights for layer res4a_branch2a...
    Threshold params shape= (256,)
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  6.338730584183701 , sf_layer_out:  0.04991126444239135
    Threshold out shape= ()
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  6.338730584183701 , sf_layer_out:  0.04991126444239135
    bw_layer_in:  8
    th_layer_in:  5.956504426896572
    bw_layer_out:  8
    th_layer_out:  6.338730584183701
    --------------------------------------------------------------------------------
    Processing layer 65 of 139
    Layer Name:res4a_branch2a_relu Type:ReLU
    Inputs: ['res4a_branch2a'], Outputs: ['res4a_branch2a']
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  5.77616006794036 , sf_layer_out:  0.04548157533811307
    bw_layer_out:  8
    th_layer_out:  5.77616006794036
    --------------------------------------------------------------------------------
    Processing layer 66 of 139
    Layer Name:res4a_branch2b Type:Convolution
    Inputs: ['res4a_branch2a'], Outputs: ['res4a_branch2b']
    Quantizing conv input layer ... res4a_branch2b
    Threshold in shape= ()
    Quantizing conv weights for layer res4a_branch2b...
    Threshold params shape= (256,)
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  6.135581972847226 , sf_layer_out:  0.048311669077537214
    Threshold out shape= ()
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  6.135581972847226 , sf_layer_out:  0.048311669077537214
    bw_layer_in:  8
    th_layer_in:  5.77616006794036
    bw_layer_out:  8
    th_layer_out:  6.135581972847226
    --------------------------------------------------------------------------------
    Processing layer 67 of 139
    Layer Name:res4a_branch2b_relu Type:ReLU
    Inputs: ['res4a_branch2b'], Outputs: ['res4a_branch2b']
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  5.390883855263141 , sf_layer_out:  0.042447904372150715
    bw_layer_out:  8
    th_layer_out:  5.390883855263141
    --------------------------------------------------------------------------------
    Processing layer 68 of 139
    Layer Name:res4a_branch2c Type:Convolution
    Inputs: ['res4a_branch2b'], Outputs: ['res4a_branch2c']
    Quantizing conv input layer ... res4a_branch2c
    Threshold in shape= ()
    Quantizing conv weights for layer res4a_branch2c...
    Threshold params shape= (1024,)
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  7.27341283006999 , sf_layer_out:  0.057270967165905434
    Threshold out shape= ()
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  7.27341283006999 , sf_layer_out:  0.057270967165905434
    bw_layer_in:  8
    th_layer_in:  5.390883855263141
    bw_layer_out:  8
    th_layer_out:  7.27341283006999
    --------------------------------------------------------------------------------
    Processing layer 69 of 139
    Layer Name:res4a Type:Eltwise
    Inputs: ['res4a_branch1', 'res4a_branch2c'], Outputs: ['res4a']
    bw_layer_in:  8
    th_layer_in:  7.918170494988138
    bw_layer_out:  8
    th_layer_out:  7.918170494988138
    --------------------------------------------------------------------------------
    Processing layer 70 of 139
    Layer Name:res4a_relu Type:ReLU
    Inputs: ['res4a'], Outputs: ['res4a']
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  12.92278621287 , sf_layer_out:  0.10175422214858267
    bw_layer_out:  8
    th_layer_out:  12.92278621287
    --------------------------------------------------------------------------------
    Processing layer 71 of 139
    Layer Name:res4a_res4a_relu_0_split Type:Split
    Inputs: ['res4a'], Outputs: ['res4a_res4a_relu_0_split_0', 'res4a_res4a_relu_0_split_1']
    bw_layer_in:  8
    th_layer_in:  12.92278621287
    bw_layer_out:  8
    th_layer_out:  12.92278621287
    --------------------------------------------------------------------------------
    Processing layer 72 of 139
    Layer Name:res4b_branch2a Type:Convolution
    Inputs: ['res4a_res4a_relu_0_split_0'], Outputs: ['res4b_branch2a']
    Quantizing conv input layer ... res4b_branch2a
    Threshold in shape= ()
    Quantizing conv weights for layer res4b_branch2a...
    Threshold params shape= (256,)
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  6.139303137451316 , sf_layer_out:  0.04834096958623083
    Threshold out shape= ()
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  6.139303137451316 , sf_layer_out:  0.04834096958623083
    bw_layer_in:  8
    th_layer_in:  12.92278621287
    bw_layer_out:  8
    th_layer_out:  6.139303137451316
    --------------------------------------------------------------------------------
    Processing layer 73 of 139
    Layer Name:res4b_branch2a_relu Type:ReLU
    Inputs: ['res4b_branch2a'], Outputs: ['res4b_branch2a']
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  4.6697368065265445 , sf_layer_out:  0.03676958115375232
    bw_layer_out:  8
    th_layer_out:  4.6697368065265445
    --------------------------------------------------------------------------------
    Processing layer 74 of 139
    Layer Name:res4b_branch2b Type:Convolution
    Inputs: ['res4b_branch2a'], Outputs: ['res4b_branch2b']
    Quantizing conv input layer ... res4b_branch2b
    Threshold in shape= ()
    Quantizing conv weights for layer res4b_branch2b...
    Threshold params shape= (256,)
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  6.6329453578130675 , sf_layer_out:  0.0522279162032525
    Threshold out shape= ()
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  6.6329453578130675 , sf_layer_out:  0.0522279162032525
    bw_layer_in:  8
    th_layer_in:  4.6697368065265445
    bw_layer_out:  8
    th_layer_out:  6.6329453578130675
    --------------------------------------------------------------------------------
    Processing layer 75 of 139
    Layer Name:res4b_branch2b_relu Type:ReLU
    Inputs: ['res4b_branch2b'], Outputs: ['res4b_branch2b']
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  4.827450368306614 , sf_layer_out:  0.03801142022288673
    bw_layer_out:  8
    th_layer_out:  4.827450368306614
    --------------------------------------------------------------------------------
    Processing layer 76 of 139
    Layer Name:res4b_branch2c Type:Convolution
    Inputs: ['res4b_branch2b'], Outputs: ['res4b_branch2c']
    Quantizing conv input layer ... res4b_branch2c
    Threshold in shape= ()
    Quantizing conv weights for layer res4b_branch2c...
    Threshold params shape= (1024,)
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  5.3848104664955985 , sf_layer_out:  0.04240008241335117
    Threshold out shape= ()
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  5.3848104664955985 , sf_layer_out:  0.04240008241335117
    bw_layer_in:  8
    th_layer_in:  4.827450368306614
    bw_layer_out:  8
    th_layer_out:  5.3848104664955985
    --------------------------------------------------------------------------------
    Processing layer 77 of 139
    Layer Name:res4b Type:Eltwise
    Inputs: ['res4a_res4a_relu_0_split_1', 'res4b_branch2c'], Outputs: ['res4b']
    bw_layer_in:  8
    th_layer_in:  12.92278621287
    bw_layer_out:  8
    th_layer_out:  12.92278621287
    --------------------------------------------------------------------------------
    Processing layer 78 of 139
    Layer Name:res4b_relu Type:ReLU
    Inputs: ['res4b'], Outputs: ['res4b']
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  5.76203337603187 , sf_layer_out:  0.04537034154355803
    bw_layer_out:  8
    th_layer_out:  5.76203337603187
    --------------------------------------------------------------------------------
    Processing layer 79 of 139
    Layer Name:res4b_res4b_relu_0_split Type:Split
    Inputs: ['res4b'], Outputs: ['res4b_res4b_relu_0_split_0', 'res4b_res4b_relu_0_split_1']
    bw_layer_in:  8
    th_layer_in:  5.76203337603187
    bw_layer_out:  8
    th_layer_out:  5.76203337603187
    --------------------------------------------------------------------------------
    Processing layer 80 of 139
    Layer Name:res4c_branch2a Type:Convolution
    Inputs: ['res4b_res4b_relu_0_split_0'], Outputs: ['res4c_branch2a']
    Quantizing conv input layer ... res4c_branch2a
    Threshold in shape= ()
    Quantizing conv weights for layer res4c_branch2a...
    Threshold params shape= (256,)
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  6.505645891845414 , sf_layer_out:  0.051225558203507195
    Threshold out shape= ()
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  6.505645891845414 , sf_layer_out:  0.051225558203507195
    bw_layer_in:  8
    th_layer_in:  5.76203337603187
    bw_layer_out:  8
    th_layer_out:  6.505645891845414
    --------------------------------------------------------------------------------
    Processing layer 81 of 139
    Layer Name:res4c_branch2a_relu Type:ReLU
    Inputs: ['res4c_branch2a'], Outputs: ['res4c_branch2a']
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  4.972908857869049 , sf_layer_out:  0.039156762660386216
    bw_layer_out:  8
    th_layer_out:  4.972908857869049
    --------------------------------------------------------------------------------
    Processing layer 82 of 139
    Layer Name:res4c_branch2b Type:Convolution
    Inputs: ['res4c_branch2a'], Outputs: ['res4c_branch2b']
    Quantizing conv input layer ... res4c_branch2b
    Threshold in shape= ()
    Quantizing conv weights for layer res4c_branch2b...
    Threshold params shape= (256,)
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  7.229865499475401 , sf_layer_out:  0.0569280747990189
    Threshold out shape= ()
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  7.229865499475401 , sf_layer_out:  0.0569280747990189
    bw_layer_in:  8
    th_layer_in:  4.972908857869049
    bw_layer_out:  8
    th_layer_out:  7.229865499475401
    --------------------------------------------------------------------------------
    Processing layer 83 of 139
    Layer Name:res4c_branch2b_relu Type:ReLU
    Inputs: ['res4c_branch2b'], Outputs: ['res4c_branch2b']
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  5.596281493875883 , sf_layer_out:  0.044065208613195926
    bw_layer_out:  8
    th_layer_out:  5.596281493875883
    --------------------------------------------------------------------------------
    Processing layer 84 of 139
    Layer Name:res4c_branch2c Type:Convolution
    Inputs: ['res4c_branch2b'], Outputs: ['res4c_branch2c']
    Quantizing conv input layer ... res4c_branch2c
    Threshold in shape= ()
    Quantizing conv weights for layer res4c_branch2c...
    Threshold params shape= (1024,)
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  4.461012181799495 , sf_layer_out:  0.03512608017164957
    Threshold out shape= ()
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  4.461012181799495 , sf_layer_out:  0.03512608017164957
    bw_layer_in:  8
    th_layer_in:  5.596281493875883
    bw_layer_out:  8
    th_layer_out:  4.461012181799495
    --------------------------------------------------------------------------------
    Processing layer 85 of 139
    Layer Name:res4c Type:Eltwise
    Inputs: ['res4b_res4b_relu_0_split_1', 'res4c_branch2c'], Outputs: ['res4c']
    bw_layer_in:  8
    th_layer_in:  5.76203337603187
    bw_layer_out:  8
    th_layer_out:  5.76203337603187
    --------------------------------------------------------------------------------
    Processing layer 86 of 139
    Layer Name:res4c_relu Type:ReLU
    Inputs: ['res4c'], Outputs: ['res4c']
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  8.77127093621985 , sf_layer_out:  0.06906512548204606
    bw_layer_out:  8
    th_layer_out:  8.77127093621985
    --------------------------------------------------------------------------------
    Processing layer 87 of 139
    Layer Name:res4c_res4c_relu_0_split Type:Split
    Inputs: ['res4c'], Outputs: ['res4c_res4c_relu_0_split_0', 'res4c_res4c_relu_0_split_1']
    bw_layer_in:  8
    th_layer_in:  8.77127093621985
    bw_layer_out:  8
    th_layer_out:  8.77127093621985
    --------------------------------------------------------------------------------
    Processing layer 88 of 139
    Layer Name:res4d_branch2a Type:Convolution
    Inputs: ['res4c_res4c_relu_0_split_0'], Outputs: ['res4d_branch2a']
    Quantizing conv input layer ... res4d_branch2a
    Threshold in shape= ()
    Quantizing conv weights for layer res4d_branch2a...
    Threshold params shape= (256,)
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  5.211271542479939 , sf_layer_out:  0.04103363419275543
    Threshold out shape= ()
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  5.211271542479939 , sf_layer_out:  0.04103363419275543
    bw_layer_in:  8
    th_layer_in:  8.77127093621985
    bw_layer_out:  8
    th_layer_out:  5.211271542479939
    --------------------------------------------------------------------------------
    Processing layer 89 of 139
    Layer Name:res4d_branch2a_relu Type:ReLU
    Inputs: ['res4d_branch2a'], Outputs: ['res4d_branch2a']
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  4.840319951626029 , sf_layer_out:  0.0381127555246144
    bw_layer_out:  8
    th_layer_out:  4.840319951626029
    --------------------------------------------------------------------------------
    Processing layer 90 of 139
    Layer Name:res4d_branch2b Type:Convolution
    Inputs: ['res4d_branch2a'], Outputs: ['res4d_branch2b']
    Quantizing conv input layer ... res4d_branch2b
    Threshold in shape= ()
    Quantizing conv weights for layer res4d_branch2b...
    Threshold params shape= (256,)
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  5.617146918450244 , sf_layer_out:  0.04422950329488381
    Threshold out shape= ()
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  5.617146918450244 , sf_layer_out:  0.04422950329488381
    bw_layer_in:  8
    th_layer_in:  4.840319951626029
    bw_layer_out:  8
    th_layer_out:  5.617146918450244
    --------------------------------------------------------------------------------
    Processing layer 91 of 139
    Layer Name:res4d_branch2b_relu Type:ReLU
    Inputs: ['res4d_branch2b'], Outputs: ['res4d_branch2b']
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  6.142565441432435 , sf_layer_out:  0.048366657019153034
    bw_layer_out:  8
    th_layer_out:  6.142565441432435
    --------------------------------------------------------------------------------
    Processing layer 92 of 139
    Layer Name:res4d_branch2c Type:Convolution
    Inputs: ['res4d_branch2b'], Outputs: ['res4d_branch2c']
    Quantizing conv input layer ... res4d_branch2c
    Threshold in shape= ()
    Quantizing conv weights for layer res4d_branch2c...
    Threshold params shape= (1024,)
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  5.1011749325490525 , sf_layer_out:  0.040166731752354745
    Threshold out shape= ()
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  5.1011749325490525 , sf_layer_out:  0.040166731752354745
    bw_layer_in:  8
    th_layer_in:  6.142565441432435
    bw_layer_out:  8
    th_layer_out:  5.1011749325490525
    --------------------------------------------------------------------------------
    Processing layer 93 of 139
    Layer Name:res4d Type:Eltwise
    Inputs: ['res4c_res4c_relu_0_split_1', 'res4d_branch2c'], Outputs: ['res4d']
    bw_layer_in:  8
    th_layer_in:  8.77127093621985
    bw_layer_out:  8
    th_layer_out:  8.77127093621985
    --------------------------------------------------------------------------------
    Processing layer 94 of 139
    Layer Name:res4d_relu Type:ReLU
    Inputs: ['res4d'], Outputs: ['res4d']
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  5.554077978013817 , sf_layer_out:  0.04373289746467572
    bw_layer_out:  8
    th_layer_out:  5.554077978013817
    --------------------------------------------------------------------------------
    Processing layer 95 of 139
    Layer Name:res4d_res4d_relu_0_split Type:Split
    Inputs: ['res4d'], Outputs: ['res4d_res4d_relu_0_split_0', 'res4d_res4d_relu_0_split_1']
    bw_layer_in:  8
    th_layer_in:  5.554077978013817
    bw_layer_out:  8
    th_layer_out:  5.554077978013817
    --------------------------------------------------------------------------------
    Processing layer 96 of 139
    Layer Name:res4e_branch2a Type:Convolution
    Inputs: ['res4d_res4d_relu_0_split_0'], Outputs: ['res4e_branch2a']
    Quantizing conv input layer ... res4e_branch2a
    Threshold in shape= ()
    Quantizing conv weights for layer res4e_branch2a...
    Threshold params shape= (256,)
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  5.880335364055934 , sf_layer_out:  0.046301853260282945
    Threshold out shape= ()
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  5.880335364055934 , sf_layer_out:  0.046301853260282945
    bw_layer_in:  8
    th_layer_in:  5.554077978013817
    bw_layer_out:  8
    th_layer_out:  5.880335364055934
    --------------------------------------------------------------------------------
    Processing layer 97 of 139
    Layer Name:res4e_branch2a_relu Type:ReLU
    Inputs: ['res4e_branch2a'], Outputs: ['res4e_branch2a']
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  6.272808840598218 , sf_layer_out:  0.04939219559526156
    bw_layer_out:  8
    th_layer_out:  6.272808840598218
    --------------------------------------------------------------------------------
    Processing layer 98 of 139
    Layer Name:res4e_branch2b Type:Convolution
    Inputs: ['res4e_branch2a'], Outputs: ['res4e_branch2b']
    Quantizing conv input layer ... res4e_branch2b
    Threshold in shape= ()
    Quantizing conv weights for layer res4e_branch2b...
    Threshold params shape= (256,)
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  6.254085415169268 , sf_layer_out:  0.04924476704857691
    Threshold out shape= ()
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  6.254085415169268 , sf_layer_out:  0.04924476704857691
    bw_layer_in:  8
    th_layer_in:  6.272808840598218
    bw_layer_out:  8
    th_layer_out:  6.254085415169268
    --------------------------------------------------------------------------------
    Processing layer 99 of 139
    Layer Name:res4e_branch2b_relu Type:ReLU
    Inputs: ['res4e_branch2b'], Outputs: ['res4e_branch2b']
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  6.285394979200153 , sf_layer_out:  0.0494912990488201
    bw_layer_out:  8
    th_layer_out:  6.285394979200153
    --------------------------------------------------------------------------------
    Processing layer 100 of 139
    Layer Name:res4e_branch2c Type:Convolution
    Inputs: ['res4e_branch2b'], Outputs: ['res4e_branch2c']
    Quantizing conv input layer ... res4e_branch2c
    Threshold in shape= ()
    Quantizing conv weights for layer res4e_branch2c...
    Threshold params shape= (1024,)
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  4.449697831451704 , sf_layer_out:  0.03503699079883232
    Threshold out shape= ()
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  4.449697831451704 , sf_layer_out:  0.03503699079883232
    bw_layer_in:  8
    th_layer_in:  6.285394979200153
    bw_layer_out:  8
    th_layer_out:  4.449697831451704
    --------------------------------------------------------------------------------
    Processing layer 101 of 139
    Layer Name:res4e Type:Eltwise
    Inputs: ['res4d_res4d_relu_0_split_1', 'res4e_branch2c'], Outputs: ['res4e']
    bw_layer_in:  8
    th_layer_in:  5.554077978013817
    bw_layer_out:  8
    th_layer_out:  5.554077978013817
    --------------------------------------------------------------------------------
    Processing layer 102 of 139
    Layer Name:res4e_relu Type:ReLU
    Inputs: ['res4e'], Outputs: ['res4e']
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  7.846795767263659 , sf_layer_out:  0.06178579344302094
    bw_layer_out:  8
    th_layer_out:  7.846795767263659
    --------------------------------------------------------------------------------
    Processing layer 103 of 139
    Layer Name:res4e_res4e_relu_0_split Type:Split
    Inputs: ['res4e'], Outputs: ['res4e_res4e_relu_0_split_0', 'res4e_res4e_relu_0_split_1']
    bw_layer_in:  8
    th_layer_in:  7.846795767263659
    bw_layer_out:  8
    th_layer_out:  7.846795767263659
    --------------------------------------------------------------------------------
    Processing layer 104 of 139
    Layer Name:res4f_branch2a Type:Convolution
    Inputs: ['res4e_res4e_relu_0_split_0'], Outputs: ['res4f_branch2a']
    Quantizing conv input layer ... res4f_branch2a
    Threshold in shape= ()
    Quantizing conv weights for layer res4f_branch2a...
    Threshold params shape= (256,)
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  5.411138480394044 , sf_layer_out:  0.04260738960940192
    Threshold out shape= ()
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  5.411138480394044 , sf_layer_out:  0.04260738960940192
    bw_layer_in:  8
    th_layer_in:  7.846795767263659
    bw_layer_out:  8
    th_layer_out:  5.411138480394044
    --------------------------------------------------------------------------------
    Processing layer 105 of 139
    Layer Name:res4f_branch2a_relu Type:ReLU
    Inputs: ['res4f_branch2a'], Outputs: ['res4f_branch2a']
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  5.220881284599424 , sf_layer_out:  0.04110930145353878
    bw_layer_out:  8
    th_layer_out:  5.220881284599424
    --------------------------------------------------------------------------------
    Processing layer 106 of 139
    Layer Name:res4f_branch2b Type:Convolution
    Inputs: ['res4f_branch2a'], Outputs: ['res4f_branch2b']
    Quantizing conv input layer ... res4f_branch2b
    Threshold in shape= ()
    Quantizing conv weights for layer res4f_branch2b...
    Threshold params shape= (256,)
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  5.922187317056987 , sf_layer_out:  0.04663139619729911
    Threshold out shape= ()
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  5.922187317056987 , sf_layer_out:  0.04663139619729911
    bw_layer_in:  8
    th_layer_in:  5.220881284599424
    bw_layer_out:  8
    th_layer_out:  5.922187317056987
    --------------------------------------------------------------------------------
    Processing layer 107 of 139
    Layer Name:res4f_branch2b_relu Type:ReLU
    Inputs: ['res4f_branch2b'], Outputs: ['res4f_branch2b']
    n:  128 , len(bin_edges):  635
    Mean : th_layer_out:  6.047241046225611 , sf_layer_out:  0.047616071230122924
    bw_layer_out:  8
    th_layer_out:  6.047241046225611
    --------------------------------------------------------------------------------
    Processing layer 108 of 139
    Layer Name:res4f_branch2c Type:Convolution
    Inputs: ['res4f_branch2b'], Outputs: ['res4f_branch2c']
    Quantizing conv input layer ... res4f_branch2c
    Threshold in shape= ()
    Quantizing conv weights for layer res4f_branch2c...
    Threshold params shape= (1024,)
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  4.5356022277465 , sf_layer_out:  0.03571340336808267
    Threshold out shape= ()
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  4.5356022277465 , sf_layer_out:  0.03571340336808267
    bw_layer_in:  8
    th_layer_in:  6.047241046225611
    bw_layer_out:  8
    th_layer_out:  4.5356022277465
    --------------------------------------------------------------------------------
    Processing layer 109 of 139
    Layer Name:res4f Type:Eltwise
    Inputs: ['res4e_res4e_relu_0_split_1', 'res4f_branch2c'], Outputs: ['res4f']
    bw_layer_in:  8
    th_layer_in:  7.846795767263659
    bw_layer_out:  8
    th_layer_out:  7.846795767263659
    --------------------------------------------------------------------------------
    Processing layer 110 of 139
    Layer Name:res4f_relu Type:ReLU
    Inputs: ['res4f'], Outputs: ['res4f']
    n:  128 , len(bin_edges):  1269
    Mean : th_layer_out:  5.403820565822373 , sf_layer_out:  0.04254976823482183
    bw_layer_out:  8
    th_layer_out:  5.403820565822373
    --------------------------------------------------------------------------------
    Processing layer 111 of 139
    Layer Name:res4f_res4f_relu_0_split Type:Split
    Inputs: ['res4f'], Outputs: ['res4f_res4f_relu_0_split_0', 'res4f_res4f_relu_0_split_1']
    bw_layer_in:  8
    th_layer_in:  5.403820565822373
    bw_layer_out:  8
    th_layer_out:  5.403820565822373
    --------------------------------------------------------------------------------
    Processing layer 112 of 139
    Layer Name:res5a_branch1 Type:Convolution
    Inputs: ['res4f_res4f_relu_0_split_0'], Outputs: ['res5a_branch1']
    Quantizing conv input layer ... res5a_branch1
    Threshold in shape= ()
    Quantizing conv weights for layer res5a_branch1...
    Threshold params shape= (2048,)
    n:  128 , len(bin_edges):  897
    Mean : th_layer_out:  13.703042987201895 , sf_layer_out:  0.10789797627718027
    Threshold out shape= ()
    n:  128 , len(bin_edges):  897
    Mean : th_layer_out:  13.703042987201895 , sf_layer_out:  0.10789797627718027
    bw_layer_in:  8
    th_layer_in:  5.403820565822373
    bw_layer_out:  8
    th_layer_out:  13.703042987201895
    --------------------------------------------------------------------------------
    Processing layer 113 of 139
    Layer Name:res5a_branch2a Type:Convolution
    Inputs: ['res4f_res4f_relu_0_split_1'], Outputs: ['res5a_branch2a']
    Quantizing conv input layer ... res5a_branch2a
    Threshold in shape= ()
    Quantizing conv weights for layer res5a_branch2a...
    Threshold params shape= (512,)
    n:  128 , len(bin_edges):  450
    Mean : th_layer_out:  5.488373673041838 , sf_layer_out:  0.0432155407326129
    Threshold out shape= ()
    n:  128 , len(bin_edges):  450
    Mean : th_layer_out:  5.488373673041838 , sf_layer_out:  0.0432155407326129
    bw_layer_in:  8
    th_layer_in:  5.403820565822373
    bw_layer_out:  8
    th_layer_out:  5.488373673041838
    --------------------------------------------------------------------------------
    Processing layer 114 of 139
    Layer Name:res5a_branch2a_relu Type:ReLU
    Inputs: ['res5a_branch2a'], Outputs: ['res5a_branch2a']
    n:  128 , len(bin_edges):  449
    Mean : th_layer_out:  4.789670756884983 , sf_layer_out:  0.03771394296759829
    bw_layer_out:  8
    th_layer_out:  4.789670756884983
    --------------------------------------------------------------------------------
    Processing layer 115 of 139
    Layer Name:res5a_branch2b Type:Convolution
    Inputs: ['res5a_branch2a'], Outputs: ['res5a_branch2b']
    Quantizing conv input layer ... res5a_branch2b
    Threshold in shape= ()
    Quantizing conv weights for layer res5a_branch2b...
    Threshold params shape= (512,)
    n:  128 , len(bin_edges):  450
    Mean : th_layer_out:  5.959953020303978 , sf_layer_out:  0.0469287639394014
    Threshold out shape= ()
    n:  128 , len(bin_edges):  450
    Mean : th_layer_out:  5.959953020303978 , sf_layer_out:  0.0469287639394014
    bw_layer_in:  8
    th_layer_in:  4.789670756884983
    bw_layer_out:  8
    th_layer_out:  5.959953020303978
    --------------------------------------------------------------------------------
    Processing layer 116 of 139
    Layer Name:res5a_branch2b_relu Type:ReLU
    Inputs: ['res5a_branch2b'], Outputs: ['res5a_branch2b']
    n:  128 , len(bin_edges):  449
    Mean : th_layer_out:  5.071013356958117 , sf_layer_out:  0.039929239031166276
    bw_layer_out:  8
    th_layer_out:  5.071013356958117
    --------------------------------------------------------------------------------
    Processing layer 117 of 139
    Layer Name:res5a_branch2c Type:Convolution
    Inputs: ['res5a_branch2b'], Outputs: ['res5a_branch2c']
    Quantizing conv input layer ... res5a_branch2c
    Threshold in shape= ()
    Quantizing conv weights for layer res5a_branch2c...
    Threshold params shape= (2048,)
    n:  128 , len(bin_edges):  898
    Mean : th_layer_out:  9.827374951097877 , sf_layer_out:  0.07738090512675494
    Threshold out shape= ()
    n:  128 , len(bin_edges):  898
    Mean : th_layer_out:  9.827374951097877 , sf_layer_out:  0.07738090512675494
    bw_layer_in:  8
    th_layer_in:  5.071013356958117
    bw_layer_out:  8
    th_layer_out:  9.827374951097877
    --------------------------------------------------------------------------------
    Processing layer 118 of 139
    Layer Name:res5a Type:Eltwise
    Inputs: ['res5a_branch1', 'res5a_branch2c'], Outputs: ['res5a']
    bw_layer_in:  8
    th_layer_in:  13.703042987201895
    bw_layer_out:  8
    th_layer_out:  13.703042987201895
    --------------------------------------------------------------------------------
    Processing layer 119 of 139
    Layer Name:res5a_relu Type:ReLU
    Inputs: ['res5a'], Outputs: ['res5a']
    n:  128 , len(bin_edges):  897
    Mean : th_layer_out:  18.496073082089424 , sf_layer_out:  0.14563837072511357
    bw_layer_out:  8
    th_layer_out:  18.496073082089424
    --------------------------------------------------------------------------------
    Processing layer 120 of 139
    Layer Name:res5a_res5a_relu_0_split Type:Split
    Inputs: ['res5a'], Outputs: ['res5a_res5a_relu_0_split_0', 'res5a_res5a_relu_0_split_1']
    bw_layer_in:  8
    th_layer_in:  18.496073082089424
    bw_layer_out:  8
    th_layer_out:  18.496073082089424
    --------------------------------------------------------------------------------
    Processing layer 121 of 139
    Layer Name:res5b_branch2a Type:Convolution
    Inputs: ['res5a_res5a_relu_0_split_0'], Outputs: ['res5b_branch2a']
    Quantizing conv input layer ... res5b_branch2a
    Threshold in shape= ()
    Quantizing conv weights for layer res5b_branch2a...
    Threshold params shape= (512,)
    n:  128 , len(bin_edges):  450
    Mean : th_layer_out:  5.269166394172108 , sf_layer_out:  0.041489499166709506
    Threshold out shape= ()
    n:  128 , len(bin_edges):  450
    Mean : th_layer_out:  5.269166394172108 , sf_layer_out:  0.041489499166709506
    bw_layer_in:  8
    th_layer_in:  18.496073082089424
    bw_layer_out:  8
    th_layer_out:  5.269166394172108
    --------------------------------------------------------------------------------
    Processing layer 122 of 139
    Layer Name:res5b_branch2a_relu Type:ReLU
    Inputs: ['res5b_branch2a'], Outputs: ['res5b_branch2a']
    n:  128 , len(bin_edges):  449
    Mean : th_layer_out:  4.7102821325617175 , sf_layer_out:  0.03708883568946234
    bw_layer_out:  8
    th_layer_out:  4.7102821325617175
    --------------------------------------------------------------------------------
    Processing layer 123 of 139
    Layer Name:res5b_branch2b Type:Convolution
    Inputs: ['res5b_branch2a'], Outputs: ['res5b_branch2b']
    Quantizing conv input layer ... res5b_branch2b
    Threshold in shape= ()
    Quantizing conv weights for layer res5b_branch2b...
    Threshold params shape= (512,)
    n:  128 , len(bin_edges):  450
    Mean : th_layer_out:  5.886197742215775 , sf_layer_out:  0.04634801371823445
    Threshold out shape= ()
    n:  128 , len(bin_edges):  450
    Mean : th_layer_out:  5.886197742215775 , sf_layer_out:  0.04634801371823445
    bw_layer_in:  8
    th_layer_in:  4.7102821325617175
    bw_layer_out:  8
    th_layer_out:  5.886197742215775
    --------------------------------------------------------------------------------
    Processing layer 124 of 139
    Layer Name:res5b_branch2b_relu Type:ReLU
    Inputs: ['res5b_branch2b'], Outputs: ['res5b_branch2b']
    n:  128 , len(bin_edges):  449
    Mean : th_layer_out:  4.216974935893502 , sf_layer_out:  0.033204527054279544
    bw_layer_out:  8
    th_layer_out:  4.216974935893502
    --------------------------------------------------------------------------------
    Processing layer 125 of 139
    Layer Name:res5b_branch2c Type:Convolution
    Inputs: ['res5b_branch2b'], Outputs: ['res5b_branch2c']
    Quantizing conv input layer ... res5b_branch2c
    Threshold in shape= ()
    Quantizing conv weights for layer res5b_branch2c...
    Threshold params shape= (2048,)
    n:  128 , len(bin_edges):  898
    Mean : th_layer_out:  9.519037530573716 , sf_layer_out:  0.07495305142184028
    Threshold out shape= ()
    n:  128 , len(bin_edges):  898
    Mean : th_layer_out:  9.519037530573716 , sf_layer_out:  0.07495305142184028
    bw_layer_in:  8
    th_layer_in:  4.216974935893502
    bw_layer_out:  8
    th_layer_out:  9.519037530573716
    --------------------------------------------------------------------------------
    Processing layer 126 of 139
    Layer Name:res5b Type:Eltwise
    Inputs: ['res5a_res5a_relu_0_split_1', 'res5b_branch2c'], Outputs: ['res5b']
    bw_layer_in:  8
    th_layer_in:  18.496073082089424
    bw_layer_out:  8
    th_layer_out:  18.496073082089424
    --------------------------------------------------------------------------------
    Processing layer 127 of 139
    Layer Name:res5b_relu Type:ReLU
    Inputs: ['res5b'], Outputs: ['res5b']
    n:  128 , len(bin_edges):  897
    Mean : th_layer_out:  27.728508497987473 , sf_layer_out:  0.21833471258257853
    bw_layer_out:  8
    th_layer_out:  27.728508497987473
    --------------------------------------------------------------------------------
    Processing layer 128 of 139
    Layer Name:res5b_res5b_relu_0_split Type:Split
    Inputs: ['res5b'], Outputs: ['res5b_res5b_relu_0_split_0', 'res5b_res5b_relu_0_split_1']
    bw_layer_in:  8
    th_layer_in:  27.728508497987473
    bw_layer_out:  8
    th_layer_out:  27.728508497987473
    --------------------------------------------------------------------------------
    Processing layer 129 of 139
    Layer Name:res5c_branch2a Type:Convolution
    Inputs: ['res5b_res5b_relu_0_split_0'], Outputs: ['res5c_branch2a']
    Quantizing conv input layer ... res5c_branch2a
    Threshold in shape= ()
    Quantizing conv weights for layer res5c_branch2a...
    Threshold params shape= (512,)
    n:  128 , len(bin_edges):  450
    Mean : th_layer_out:  5.64982227015336 , sf_layer_out:  0.04448678952876661
    Threshold out shape= ()
    n:  128 , len(bin_edges):  450
    Mean : th_layer_out:  5.64982227015336 , sf_layer_out:  0.04448678952876661
    bw_layer_in:  8
    th_layer_in:  27.728508497987473
    bw_layer_out:  8
    th_layer_out:  5.64982227015336
    --------------------------------------------------------------------------------
    Processing layer 130 of 139
    Layer Name:res5c_branch2a_relu Type:ReLU
    Inputs: ['res5c_branch2a'], Outputs: ['res5c_branch2a']
    n:  128 , len(bin_edges):  449
    Mean : th_layer_out:  4.821646460997207 , sf_layer_out:  0.03796572016533234
    bw_layer_out:  8
    th_layer_out:  4.821646460997207
    --------------------------------------------------------------------------------
    Processing layer 131 of 139
    Layer Name:res5c_branch2b Type:Convolution
    Inputs: ['res5c_branch2a'], Outputs: ['res5c_branch2b']
    Quantizing conv input layer ... res5c_branch2b
    Threshold in shape= ()
    Quantizing conv weights for layer res5c_branch2b...
    Threshold params shape= (512,)
    n:  128 , len(bin_edges):  450
    Mean : th_layer_out:  7.042395137200643 , sf_layer_out:  0.05545193021417829
    Threshold out shape= ()
    n:  128 , len(bin_edges):  450
    Mean : th_layer_out:  7.042395137200643 , sf_layer_out:  0.05545193021417829
    bw_layer_in:  8
    th_layer_in:  4.821646460997207
    bw_layer_out:  8
    th_layer_out:  7.042395137200643
    --------------------------------------------------------------------------------
    Processing layer 132 of 139
    Layer Name:res5c_branch2b_relu Type:ReLU
    Inputs: ['res5c_branch2b'], Outputs: ['res5c_branch2b']
    n:  128 , len(bin_edges):  449
    Mean : th_layer_out:  5.468548017420939 , sf_layer_out:  0.043059433208038886
    bw_layer_out:  8
    th_layer_out:  5.468548017420939
    --------------------------------------------------------------------------------
    Processing layer 133 of 139
    Layer Name:res5c_branch2c Type:Convolution
    Inputs: ['res5c_branch2b'], Outputs: ['res5c_branch2c']
    Quantizing conv input layer ... res5c_branch2c
    Threshold in shape= ()
    Quantizing conv weights for layer res5c_branch2c...
    Threshold params shape= (2048,)
    n:  128 , len(bin_edges):  898
    Mean : th_layer_out:  12.559613734982085 , sf_layer_out:  0.09889459633844161
    Threshold out shape= ()
    n:  128 , len(bin_edges):  898
    Mean : th_layer_out:  12.559613734982085 , sf_layer_out:  0.09889459633844161
    bw_layer_in:  8
    th_layer_in:  5.468548017420939
    bw_layer_out:  8
    th_layer_out:  12.559613734982085
    --------------------------------------------------------------------------------
    Processing layer 134 of 139
    Layer Name:res5c Type:Eltwise
    Inputs: ['res5b_res5b_relu_0_split_1', 'res5c_branch2c'], Outputs: ['res5c']
    bw_layer_in:  8
    th_layer_in:  27.728508497987473
    bw_layer_out:  8
    th_layer_out:  27.728508497987473
    --------------------------------------------------------------------------------
    Processing layer 135 of 139
    Layer Name:res5c_relu Type:ReLU
    Inputs: ['res5c'], Outputs: ['res5c']
    n:  128 , len(bin_edges):  898
    Mean : th_layer_out:  14.026849166206691 , sf_layer_out:  0.11044763122997395
    bw_layer_out:  8
    th_layer_out:  14.026849166206691
    --------------------------------------------------------------------------------
    Processing layer 136 of 139
    Layer Name:pool5 Type:Pooling
    Inputs: ['res5c'], Outputs: ['pool5']
    bw_layer_in:  8
    th_layer_in:  14.026849166206691
    bw_layer_out:  8
    th_layer_out:  14.026849166206691
    --------------------------------------------------------------------------------
    Processing layer 137 of 139
    Layer Name:fc1000 Type:InnerProduct
    Inputs: ['pool5'], Outputs: ['fc1000']
    n:  128 , len(bin_edges):  91
    Mean : th_layer_out:  28.813695907592773 , sf_layer_out:  0.22687949533537616
    bw_layer_in:  8
    th_layer_in:  14.026849166206691
    bw_layer_out:  8
    th_layer_out:  28.813695907592773
    --------------------------------------------------------------------------------
    Processing layer 138 of 139
    Layer Name:prob Type:Softmax
    Inputs: ['fc1000'], Outputs: ['prob']
    Passing
    Writing output files to work/quantization_params.json...
    Arguments:
    [('calibration_seed', None), ('mean_value', [104.007, 116.669, 122.679]), ('dims', [3, 224, 224]), ('calibration_indices', None), ('bitwidths', [8, 8, 8]), ('transpose', [2, 0, 1]), ('raw_scale', 255.0), ('calibration_size', 8), ('calibration_directory', '../xfdnn/tools/quantize/calibration_directory'), ('weights', 'work/optimized_model.caffemodel'), ('deploy_model', 'work/optimized_model.prototxt'), ('channel_swap', [2, 1, 0]), ('input_scale', 1.0), ('output_json', 'work/quantization_params.json')]
    **********
    Successfully produced quantization JSON file for 53 layers.
    


Well done! That concludes the Part 2. Now you are ready to put parts 1
and 2 together and deploy a network/model.

`Part 3: Putting it all together: Compile, Quantize and Deploy <image_classification_caffe.ipynb>`__
----------------------------------------------------------------------------------------------------
