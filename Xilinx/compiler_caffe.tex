
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{compiler\_caffe}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \section{Part 1: Using the xfDNN
Compiler}\label{part-1-using-the-xfdnn-compiler}

\subsection{Introduction}\label{introduction}

In this part, you will learn what steps are required to prepare and
compile a network and model. Before being able to deploy networks/models
to Xilinx FPGAs you will need to compile them.

This step is more than just converting the framework graph
representation to one Xilinx can execute. The xfDNN Compiler is a high
performance optimizer for Machine Learning inference. Some of the
techniques it performs are fusing and merging layers, optimizing memory
usage and pre-scheduling complete network deployment. These techniques
increase inference rates and lower inference latency.

Using the xfDNN Compiler is an offline process, which only needs to be
performed once per network. As you will see, the process is simple and
quick.

First, we will look at an example already ready to be run based on
Inception v1. Lets look at each step:

\subsubsection{1. Import the required
packages}\label{import-the-required-packages}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{k+kn}{import} \PY{n+nn}{os}\PY{o}{,}\PY{n+nn}{sys}
        \PY{k+kn}{from} \PY{n+nn}{\PYZus{}\PYZus{}future\PYZus{}\PYZus{}} \PY{k+kn}{import} \PY{n}{print\PYZus{}function}
        
        \PY{c+c1}{\PYZsh{} Bring in Xilinx ML\PYZhy{}Suite Compiler}
        \PY{k+kn}{from} \PY{n+nn}{xfdnn.tools.compile.bin.xfdnn\PYZus{}compiler\PYZus{}caffe} \PY{k+kn}{import} \PY{n}{CaffeFrontend} \PY{k}{as} \PY{n}{xfdnnCompiler}
\end{Verbatim}


    \subsubsection{2. Define a new xfdnnCompiler instance and pass
arguments}\label{define-a-new-xfdnncompiler-instance-and-pass-arguments}

To simplify handling of arguments, a config dictionary is used. Take a
look at the dictionary below.

The arguments that need to be passed are: - \texttt{prototxt} - Caffe
representation of the network - \texttt{caffemodel} - Pre-trained Model
for the network - \texttt{outmodel} - Filename to save the prototxt of
the optimized network - \texttt{fpgacommands} - Filename to save
micro-instruction produced by the compiler needed to deploy -
\texttt{memory} - Parameter to set the on-chip memory for the target
xDNN overlay. This example will target an overlay with 5 MB of cache. -
\texttt{dsp} - Parameter to set the size of the target xDNN overlay.
This example uses an overlay of size 56x32 DSPs. - \texttt{ddr} - Amount
of off-chip memory available. This example will allow the compiler to
use up to 256 MB on DDR.

The xfDNN Compiler interfaces with Caffe to read a network graph, and
generates a sequence of instructions for the xfDNN Deploy APIs to
execute on the FPGA.

During this process the xfDNN Compiler performs computational graph
traversal, node merging and optimization, memory allocation and
optimization and, finally, micro-instruction generation.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{c+c1}{\PYZsh{} Use a config dictionary to pass parameters to the compiler}
        \PY{n}{config} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
        
        \PY{c+c1}{\PYZsh{} Compiler Arguments}
        \PY{n}{config}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{prototxt}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{../models/caffe/bvlc\PYZus{}googlenet\PYZus{}without\PYZus{}lrn/fp32/bvlc\PYZus{}googlenet\PYZus{}without\PYZus{}lrn\PYZus{}deploy.prototxt}\PY{l+s+s2}{\PYZdq{}} 
        \PY{n}{config}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{caffemodel}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{../models/caffe/bvlc\PYZus{}googlenet\PYZus{}without\PYZus{}lrn/fp32/bvlc\PYZus{}googlenet\PYZus{}without\PYZus{}lrn.caffemodel}\PY{l+s+s2}{\PYZdq{}}
        \PY{n}{config}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{outmodel}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{work/optimized\PYZus{}model}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{} String for naming intermediate prototxt, caffemodel}
        \PY{n}{config}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fpgacommands}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{work/bvlc\PYZus{}googlenet\PYZus{}without\PYZus{}lrn.cmd}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{} Compiler will generate FPGA instructions}
        \PY{n}{config}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{memory}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{5} \PY{c+c1}{\PYZsh{} Available on\PYZhy{}chip SRAM}
        \PY{n}{config}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dsp}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{56} \PY{c+c1}{\PYZsh{} Width of Systolic Array}
        \PY{n}{config}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ddr}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{256} \PY{c+c1}{\PYZsh{} Available off\PYZhy{}chip DRAM}
        
        \PY{n}{compiler} \PY{o}{=} \PY{n}{xfdnnCompiler}\PY{p}{(}
            \PY{n}{verbose}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{,}
            \PY{n}{networkfile}\PY{o}{=}\PY{n}{config}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{prototxt}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,}       \PY{c+c1}{\PYZsh{} Prototxt filename: input file}
            \PY{n}{weights}\PY{o}{=}\PY{n}{config}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{caffemodel}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,}         \PY{c+c1}{\PYZsh{} Floating Point Weights: input file}
            \PY{n}{anew}\PY{o}{=}\PY{n}{config}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{outmodel}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,}              \PY{c+c1}{\PYZsh{} Filename for optimized prototxt/caffemodel}
            \PY{n}{generatefile}\PY{o}{=}\PY{n}{config}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fpgacommands}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,}  \PY{c+c1}{\PYZsh{} Script filename: output file}
            \PY{n}{memory}\PY{o}{=}\PY{n}{config}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{memory}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,}              \PY{c+c1}{\PYZsh{} Available on chip SRAM within xclbin}
            \PY{n}{dsp}\PY{o}{=}\PY{n}{config}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dsp}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,}                    \PY{c+c1}{\PYZsh{} Rows in DSP systolic array within xclbin }
            \PY{n}{ddr}\PY{o}{=}\PY{n}{config}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ddr}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}                     \PY{c+c1}{\PYZsh{} Memory to allocate in FPGA DRAM for activation spill}
        \PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} Invoke compiler}
        \PY{k}{try}\PY{p}{:}
            \PY{n}{compiler}\PY{o}{.}\PY{n}{compile}\PY{p}{(}\PY{p}{)}
        
            \PY{c+c1}{\PYZsh{} The compiler extracts the floating point weights from the .caffemodel. }
            \PY{c+c1}{\PYZsh{} This weights dir will be stored in the work dir with the appendex \PYZsq{}\PYZus{}data\PYZsq{}. }
            \PY{c+c1}{\PYZsh{} The compiler will name it after the caffemodel, and append \PYZus{}data}
            \PY{n}{config}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{datadir}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{work/}\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n}{config}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{caffemodel}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZus{}data}\PY{l+s+s2}{\PYZdq{}}
                
            \PY{k}{if} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{exists}\PY{p}{(}\PY{n}{config}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{datadir}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)} \PY{o+ow}{and} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{exists}\PY{p}{(}\PY{n}{config}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fpgacommands}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.json}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}
                \PY{k}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Compiler successfully generated JSON and the data directory: }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{config}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{datadir}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
            \PY{k}{else}\PY{p}{:}
                \PY{k}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Compiler failed to generate the JSON or data directory: }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{config}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{datadir}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
                \PY{k}{raise}
                
            \PY{k}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{**********}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{Compilation Successful!}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
            
            \PY{k+kn}{import} \PY{n+nn}{json}
            \PY{n}{data} \PY{o}{=} \PY{n}{json}\PY{o}{.}\PY{n}{loads}\PY{p}{(}\PY{n+nb}{open}\PY{p}{(}\PY{n}{config}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fpgacommands}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.json}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{o}{.}\PY{n}{read}\PY{p}{(}\PY{p}{)}\PY{p}{)}
            \PY{k}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Network Operations Count: }\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s2}{\PYZdq{}}\PY{o}{\PYZpc{}}\PY{k}{data}[\PYZsq{}ops\PYZsq{}])
            \PY{k}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DDR Transfers (bytes): }\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s2}{\PYZdq{}}\PY{o}{\PYZpc{}}\PY{k}{data}[\PYZsq{}moveops\PYZsq{}]) 
            
        \PY{k}{except} \PY{n+ne}{Exception} \PY{k}{as} \PY{n}{e}\PY{p}{:}
            \PY{k}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Failed to complete compilation:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{e}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Network: ../models/caffe/bvlc\_googlenet\_without\_lrn/fp32/bvlc\_googlenet\_without\_lrn\_deploy.prototxt
GenerateCode: work/bvlc\_googlenet\_without\_lrn.cmd
Weights: ../models/caffe/bvlc\_googlenet\_without\_lrn/fp32/bvlc\_googlenet\_without\_lrn.caffemodel
PngFile: None
ConcatStrategy: None
Strategy: all
ScheduleFile: None
DSP: 56
Verbose: False
FromTF: False
Memory: 5
DDR: 256
Phase: TEST
RankDir: BT

**************************************************
* BUILDING DATA FLOW GRAPH
**************************************************

**************************************************
* BUILDING NETWORK SCHEDULE
**************************************************
Network Schedule ['data', 'conv1/7x7\_s2', 'conv1/relu\_7x7', 'pool1/3x3\_s2', 'conv2/3x3\_reduce', 'conv2/relu\_3x3\_reduce', 'conv2/3x3', 'conv2/relu\_3x3', 'pool2/3x3\_s2', 'inception\_3a/1x1', 'inception\_3a/relu\_1x1', 'inception\_3a/3x3\_reduce', 'inception\_3a/relu\_3x3\_reduce', 'inception\_3a/3x3', 'inception\_3a/relu\_3x3', 'inception\_3a/5x5\_reduce', 'inception\_3a/relu\_5x5\_reduce', 'inception\_3a/5x5', 'inception\_3a/relu\_5x5', 'inception\_3a/pool', 'inception\_3a/pool\_proj', 'inception\_3a/relu\_pool\_proj', 'inception\_3a/output', 'inception\_3b/1x1', 'inception\_3b/relu\_1x1', 'inception\_3b/3x3\_reduce', 'inception\_3b/relu\_3x3\_reduce', 'inception\_3b/3x3', 'inception\_3b/relu\_3x3', 'inception\_3b/5x5\_reduce', 'inception\_3b/relu\_5x5\_reduce', 'inception\_3b/5x5', 'inception\_3b/relu\_5x5', 'inception\_3b/pool', 'inception\_3b/pool\_proj', 'inception\_3b/relu\_pool\_proj', 'inception\_3b/output', 'pool3/3x3\_s2', 'inception\_4a/1x1', 'inception\_4a/relu\_1x1', 'inception\_4a/3x3\_reduce', 'inception\_4a/relu\_3x3\_reduce', 'inception\_4a/3x3', 'inception\_4a/relu\_3x3', 'inception\_4a/5x5\_reduce', 'inception\_4a/relu\_5x5\_reduce', 'inception\_4a/5x5', 'inception\_4a/relu\_5x5', 'inception\_4a/pool', 'inception\_4a/pool\_proj', 'inception\_4a/relu\_pool\_proj', 'inception\_4a/output', 'inception\_4b/1x1', 'inception\_4b/relu\_1x1', 'inception\_4b/3x3\_reduce', 'inception\_4b/relu\_3x3\_reduce', 'inception\_4b/3x3', 'inception\_4b/relu\_3x3', 'inception\_4b/5x5\_reduce', 'inception\_4b/relu\_5x5\_reduce', 'inception\_4b/5x5', 'inception\_4b/relu\_5x5', 'inception\_4b/pool', 'inception\_4b/pool\_proj', 'inception\_4b/relu\_pool\_proj', 'inception\_4b/output', 'inception\_4c/1x1', 'inception\_4c/relu\_1x1', 'inception\_4c/3x3\_reduce', 'inception\_4c/relu\_3x3\_reduce', 'inception\_4c/3x3', 'inception\_4c/relu\_3x3', 'inception\_4c/5x5\_reduce', 'inception\_4c/relu\_5x5\_reduce', 'inception\_4c/5x5', 'inception\_4c/relu\_5x5', 'inception\_4c/pool', 'inception\_4c/pool\_proj', 'inception\_4c/relu\_pool\_proj', 'inception\_4c/output', 'inception\_4d/1x1', 'inception\_4d/relu\_1x1', 'inception\_4d/3x3\_reduce', 'inception\_4d/relu\_3x3\_reduce', 'inception\_4d/3x3', 'inception\_4d/relu\_3x3', 'inception\_4d/5x5\_reduce', 'inception\_4d/relu\_5x5\_reduce', 'inception\_4d/5x5', 'inception\_4d/relu\_5x5', 'inception\_4d/pool', 'inception\_4d/pool\_proj', 'inception\_4d/relu\_pool\_proj', 'inception\_4d/output', 'inception\_4e/1x1', 'inception\_4e/relu\_1x1', 'inception\_4e/3x3\_reduce', 'inception\_4e/relu\_3x3\_reduce', 'inception\_4e/3x3', 'inception\_4e/relu\_3x3', 'inception\_4e/5x5\_reduce', 'inception\_4e/relu\_5x5\_reduce', 'inception\_4e/5x5', 'inception\_4e/relu\_5x5', 'inception\_4e/pool', 'inception\_4e/pool\_proj', 'inception\_4e/relu\_pool\_proj', 'inception\_4e/output', 'pool4/3x3\_s2', 'inception\_5a/1x1', 'inception\_5a/relu\_1x1', 'inception\_5a/3x3\_reduce', 'inception\_5a/relu\_3x3\_reduce', 'inception\_5a/3x3', 'inception\_5a/relu\_3x3', 'inception\_5a/5x5\_reduce', 'inception\_5a/relu\_5x5\_reduce', 'inception\_5a/5x5', 'inception\_5a/relu\_5x5', 'inception\_5a/pool', 'inception\_5a/pool\_proj', 'inception\_5a/relu\_pool\_proj', 'inception\_5a/output', 'inception\_5b/1x1', 'inception\_5b/relu\_1x1', 'inception\_5b/3x3\_reduce', 'inception\_5b/relu\_3x3\_reduce', 'inception\_5b/3x3', 'inception\_5b/relu\_3x3', 'inception\_5b/5x5\_reduce', 'inception\_5b/relu\_5x5\_reduce', 'inception\_5b/5x5', 'inception\_5b/relu\_5x5', 'inception\_5b/pool', 'inception\_5b/pool\_proj', 'inception\_5b/relu\_pool\_proj', 'inception\_5b/output', 'pool5/7x7\_s1', 'pool5/drop\_7x7\_s1', 'loss3/classifier', 'prob']

**************************************************
* COMPUTING MEMORY REQUIREMENTS
**************************************************
Minimum Memory \_\_\_\_\_\_\_\_\_\_
33 ['inception\_3b/pool'] size:3325952.0 remap:[] data movement:[]
33	inception\_3a/output\_blob M[0,917504] Z=917504 F=[23, 25, 29, 33] B=[22] E=[] S=['replace\_layer'] ['concat'] L=-1
33	inception\_3b/pool\_blob M[0,917504] Z=917504 F=[34] B=[33] E=[] S=['layer'] [] L=-1
33	inception\_3b/5x5\_blob M[0,344064] Z=344064 F=[32, 36] B=[31, 32] E=[] S=['layer'] ['concat'] L=-1
33	inception\_3b/3x3\_blob M[0,688128] Z=688128 F=[28, 36] B=[27, 28] E=[] S=['layer'] ['concat'] L=-1
33	inception\_3b/1x1\_blob M[0,458752] Z=458752 F=[24, 36] B=[23, 24] E=[] S=['layer'] ['concat'] L=-1

**************************************************
* ALLOCATING DYNAMIC MEMORY SCHEDULE
**************************************************
Allocating Memory
Trying strategy bysize

**************************************************
* GENERATING OUTPUT REPORTS
**************************************************
Minimum Memory 105 ['inception\_4e/pool\_proj'] 4300800.0
inception\_4e/pool\_blob M[3354624,4300800] Z=946176 F=[105] B=[104] E=[1] S=['layer'] [] L=0
inception\_4e/1x1\_blob M[1863680,2322432] Z=458752 F=[95, 107] B=[94, 95] E=[-1] S=['layer'] ['concat'] L=0
inception\_4e/3x3\_blob M[2322432,2895872] Z=573440 F=[99, 107] B=[98, 99] E=[-1] S=['layer'] ['concat'] L=0
inception\_4e/5x5\_blob M[2895872,3125248] Z=229376 F=[103, 107] B=[102, 103] E=[-1] S=['layer'] ['concat'] L=0
inception\_4e/pool\_proj\_blob M[3125248,3354624] Z=229376 F=[106, 107] B=[105, 106] E=[-1] S=['layer'] ['concat'] L=0

**************************************************
* GENERATING OUTPUT FILES
**************************************************
XDNN Command file: work/bvlc\_googlenet\_without\_lrn.cmd
XDNN JSON Report file: work/bvlc\_googlenet\_without\_lrn.cmd.json
OUTPUT REPORT:
Unsupported Layers: 3
0) loss3/classifier
	Attributes: ('\#\# 140 XNInner loss3/classifier 16 26 2 0x0 1 1024 0x20000 1000 1000', u'loss3/classifier: type=InnerProduct, sizes=None, shapes=[[1000, 1024], [1000]], sched 139 Kernel None Strides None Padding None  NO VALID CODE  ')
1) data
	Attributes: ("\# LAYER data [u'Input'] ['layer']", u'data: type=Input, sizes=None, shapes=None, sched 0 Kernel None Strides None Padding None  NO VALID CODE  ')
2) prob
	Attributes: ("\# LAYER prob [u'Softmax'] ['layer']", u'prob: type=Softmax, sizes=None, shapes=None, sched 140 Kernel None Strides None Padding None  NO VALID CODE  ')
Compiling weights from: ../models/caffe/bvlc\_googlenet\_without\_lrn/fp32/bvlc\_googlenet\_without\_lrn.caffemodel
Writing weights to directory work/bvlc\_googlenet\_without\_lrn.caffemodel\_data
SUCCESS

*************************************************
* GENERATING new PROTO and new caffemodel weights  
***************************************************
conv1/7x7\_s2 0: (64, 3, 7, 7) (64, 3, 7, 7)
conv2/3x3\_reduce 0: (64, 64, 1, 1) (64, 64, 1, 1)
conv2/3x3 0: (192, 64, 3, 3) (192, 64, 3, 3)
inception\_3a/1x1 0: (64, 192, 1, 1) (64, 192, 1, 1)
inception\_3a/3x3\_reduce 0: (96, 192, 1, 1) (96, 192, 1, 1)
inception\_3a/3x3 0: (128, 96, 3, 3) (128, 96, 3, 3)
inception\_3a/5x5\_reduce 0: (16, 192, 1, 1) (16, 192, 1, 1)
inception\_3a/5x5 0: (32, 16, 5, 5) (32, 16, 5, 5)
inception\_3a/pool\_proj 0: (32, 192, 1, 1) (32, 192, 1, 1)
inception\_3b/1x1 0: (128, 256, 1, 1) (128, 256, 1, 1)
inception\_3b/3x3\_reduce 0: (128, 256, 1, 1) (128, 256, 1, 1)
inception\_3b/3x3 0: (192, 128, 3, 3) (192, 128, 3, 3)
inception\_3b/5x5\_reduce 0: (32, 256, 1, 1) (32, 256, 1, 1)
inception\_3b/5x5 0: (96, 32, 5, 5) (96, 32, 5, 5)
inception\_3b/pool\_proj 0: (64, 256, 1, 1) (64, 256, 1, 1)
inception\_4a/1x1 0: (192, 480, 1, 1) (192, 480, 1, 1)
inception\_4a/3x3\_reduce 0: (96, 480, 1, 1) (96, 480, 1, 1)
inception\_4a/3x3 0: (208, 96, 3, 3) (208, 96, 3, 3)
inception\_4a/5x5\_reduce 0: (16, 480, 1, 1) (16, 480, 1, 1)
inception\_4a/5x5 0: (48, 16, 5, 5) (48, 16, 5, 5)
inception\_4a/pool\_proj 0: (64, 480, 1, 1) (64, 480, 1, 1)
inception\_4b/1x1 0: (160, 512, 1, 1) (160, 512, 1, 1)
inception\_4b/3x3\_reduce 0: (112, 512, 1, 1) (112, 512, 1, 1)
inception\_4b/3x3 0: (224, 112, 3, 3) (224, 112, 3, 3)
inception\_4b/5x5\_reduce 0: (24, 512, 1, 1) (24, 512, 1, 1)
inception\_4b/5x5 0: (64, 24, 5, 5) (64, 24, 5, 5)
inception\_4b/pool\_proj 0: (64, 512, 1, 1) (64, 512, 1, 1)
inception\_4c/1x1 0: (128, 512, 1, 1) (128, 512, 1, 1)
inception\_4c/3x3\_reduce 0: (128, 512, 1, 1) (128, 512, 1, 1)
inception\_4c/3x3 0: (256, 128, 3, 3) (256, 128, 3, 3)
inception\_4c/5x5\_reduce 0: (24, 512, 1, 1) (24, 512, 1, 1)
inception\_4c/5x5 0: (64, 24, 5, 5) (64, 24, 5, 5)
inception\_4c/pool\_proj 0: (64, 512, 1, 1) (64, 512, 1, 1)
inception\_4d/1x1 0: (112, 512, 1, 1) (112, 512, 1, 1)
inception\_4d/3x3\_reduce 0: (144, 512, 1, 1) (144, 512, 1, 1)
inception\_4d/3x3 0: (288, 144, 3, 3) (288, 144, 3, 3)
inception\_4d/5x5\_reduce 0: (32, 512, 1, 1) (32, 512, 1, 1)
inception\_4d/5x5 0: (64, 32, 5, 5) (64, 32, 5, 5)
inception\_4d/pool\_proj 0: (64, 512, 1, 1) (64, 512, 1, 1)
inception\_4e/1x1 0: (256, 528, 1, 1) (256, 528, 1, 1)
inception\_4e/3x3\_reduce 0: (160, 528, 1, 1) (160, 528, 1, 1)
inception\_4e/3x3 0: (320, 160, 3, 3) (320, 160, 3, 3)
inception\_4e/5x5\_reduce 0: (32, 528, 1, 1) (32, 528, 1, 1)
inception\_4e/5x5 0: (128, 32, 5, 5) (128, 32, 5, 5)
inception\_4e/pool\_proj 0: (128, 528, 1, 1) (128, 528, 1, 1)
inception\_5a/1x1 0: (256, 832, 1, 1) (256, 832, 1, 1)
inception\_5a/3x3\_reduce 0: (160, 832, 1, 1) (160, 832, 1, 1)
inception\_5a/3x3 0: (320, 160, 3, 3) (320, 160, 3, 3)
inception\_5a/5x5\_reduce 0: (32, 832, 1, 1) (32, 832, 1, 1)
inception\_5a/5x5 0: (128, 32, 5, 5) (128, 32, 5, 5)
inception\_5a/pool\_proj 0: (128, 832, 1, 1) (128, 832, 1, 1)
inception\_5b/1x1 0: (384, 832, 1, 1) (384, 832, 1, 1)
inception\_5b/3x3\_reduce 0: (192, 832, 1, 1) (192, 832, 1, 1)
inception\_5b/3x3 0: (384, 192, 3, 3) (384, 192, 3, 3)
inception\_5b/5x5\_reduce 0: (48, 832, 1, 1) (48, 832, 1, 1)
inception\_5b/5x5 0: (128, 48, 5, 5) (128, 48, 5, 5)
inception\_5b/pool\_proj 0: (128, 832, 1, 1) (128, 832, 1, 1)
Compiler successfully generated JSON and the data directory: work/bvlc\_googlenet\_without\_lrn.caffemodel\_data
**********
Compilation Successful!

Network Operations Count: 3176103168
DDR Transfers (bytes): 0

    \end{Verbatim}

    \subsubsection{3. Try it yourself with a different
model}\label{try-it-yourself-with-a-different-model}

Now that you have had a chance to see how this works, it's time to get
some hands on experience. Change the following from the example above:
1. The Network - From Inception v1 to ResNet50. 2. The Weights - New
Network, will require to us to re-extract the weights. 3. The amount of
on-chip memory available. 4. The size of the xDNN overlay.

Resources: ResNet50 prototxt located here:
\texttt{"../models/caffe/resnet/fp32/resnet50\_deploy.prototxt"}\\
ResNet50 caffemodel located here:
\texttt{"../models/caffe/resnet/fp32/resnet50.caffemodel"}

In the last example, you ran through the compiler using a setting of 5
MB. Try \texttt{3} for 3 MB of on-chip memory. This will restrict the
memory available to the compiler and it will automatically create DDR
transfer commands to move intermediate results between the FPGA and DDR.
You will see the DDR transfers is no longer 0 bytes.

Lastly, 56 or 28 are supported as the DSP argument, so change this to
28. This corresponds to the 28x32 DSP configuration which reduces the
number of DSPs compared to 56x32, but allows us to run twice as many CNN
processing engines.

Note: Because Resnet-50 has more opportunities to optimize the graph,
and the model parameters are approximately 2x the size of the
GoogLeVet-v1 model, it will take slightly longer to write the optimized
weights run compared to the previous GoogLeNet-v1 example.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{c+c1}{\PYZsh{} Since we already have an instance of the compiler, you can just update these params:}
        
        \PY{n}{compiler}\PY{o}{.}\PY{n}{networkfile} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{../models/caffe/resnet/fp32/resnet50\PYZus{}deploy.prototxt}\PY{l+s+s2}{\PYZdq{}}
        \PY{n}{compiler}\PY{o}{.}\PY{n}{weights} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{../models/caffe/resnet/fp32/resnet50.caffemodel}\PY{l+s+s2}{\PYZdq{}}
        \PY{n}{compiler}\PY{o}{.}\PY{n}{memory} \PY{o}{=} \PY{l+m+mi}{3}
        \PY{n}{compiler}\PY{o}{.}\PY{n}{dsp} \PY{o}{=} \PY{l+m+mi}{28}
        
        \PY{c+c1}{\PYZsh{} Invoke compiler}
        \PY{k}{try}\PY{p}{:}
            \PY{n}{compiler}\PY{o}{.}\PY{n}{compile}\PY{p}{(}\PY{p}{)}
            
            \PY{c+c1}{\PYZsh{} The compiler extracts the floating point weights from the .caffemodel. }
            \PY{c+c1}{\PYZsh{} This weights dir will be stored in the work dir with the appendex \PYZsq{}\PYZus{}data\PYZsq{}. }
            \PY{c+c1}{\PYZsh{} The compiler will name it after the caffemodel, and append \PYZus{}data}
            \PY{n}{config}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{datadir}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{work/}\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n}{config}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{caffemodel}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZus{}data}\PY{l+s+s2}{\PYZdq{}}
                
            \PY{k}{if} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{exists}\PY{p}{(}\PY{n}{config}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{datadir}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)} \PY{o+ow}{and} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{exists}\PY{p}{(}\PY{n}{config}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fpgacommands}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.json}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}
                \PY{k}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Compiler successfully generated JSON and the data directory: }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{config}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{datadir}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
            \PY{k}{else}\PY{p}{:}
                \PY{k}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Compiler failed to generate the JSON or data directory: }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{config}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{datadir}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
                \PY{k}{raise}
                
            \PY{k}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{**********}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{Compilation Successful!}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
            
            \PY{k+kn}{import} \PY{n+nn}{json}
            \PY{n}{data} \PY{o}{=} \PY{n}{json}\PY{o}{.}\PY{n}{loads}\PY{p}{(}\PY{n+nb}{open}\PY{p}{(}\PY{n}{config}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fpgacommands}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.json}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{o}{.}\PY{n}{read}\PY{p}{(}\PY{p}{)}\PY{p}{)}
            \PY{k}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Network Operations Count: }\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s2}{\PYZdq{}}\PY{o}{\PYZpc{}}\PY{k}{data}[\PYZsq{}ops\PYZsq{}])
            \PY{k}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DDR Transfers (bytes): }\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s2}{\PYZdq{}}\PY{o}{\PYZpc{}}\PY{k}{data}[\PYZsq{}moveops\PYZsq{}]) 
            
        \PY{k}{except} \PY{n+ne}{Exception} \PY{k}{as} \PY{n}{e}\PY{p}{:}
            \PY{k}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Failed to complete compilation:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{e}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Network: ../models/caffe/resnet/fp32/resnet50\_deploy.prototxt
GenerateCode: work/bvlc\_googlenet\_without\_lrn.cmd
Weights: ../models/caffe/resnet/fp32/resnet50.caffemodel
PngFile: None
ConcatStrategy: None
Strategy: all
ScheduleFile: None
DSP: 28
Verbose: False
FromTF: False
Memory: 3
DDR: 256
Phase: 1
Unknown phase: 1
RankDir: BT

**************************************************
* BUILDING DATA FLOW GRAPH
**************************************************

**************************************************
* BUILDING NETWORK SCHEDULE
**************************************************
Network Schedule ['data', 'conv1', 'bn\_conv1', 'scale\_conv1', 'conv1\_relu', 'pool1', 'res2a\_branch1', 'bn2a\_branch1', 'scale2a\_branch1', 'res2a\_branch2a', 'bn2a\_branch2a', 'scale2a\_branch2a', 'res2a\_branch2a\_relu', 'res2a\_branch2b', 'bn2a\_branch2b', 'scale2a\_branch2b', 'res2a\_branch2b\_relu', 'res2a\_branch2c', 'bn2a\_branch2c', 'scale2a\_branch2c', 'res2a', 'res2a\_relu', 'res2b\_branch2a', 'bn2b\_branch2a', 'scale2b\_branch2a', 'res2b\_branch2a\_relu', 'res2b\_branch2b', 'bn2b\_branch2b', 'scale2b\_branch2b', 'res2b\_branch2b\_relu', 'res2b\_branch2c', 'bn2b\_branch2c', 'scale2b\_branch2c', 'res2b', 'res2b\_relu', 'res2c\_branch2a', 'bn2c\_branch2a', 'scale2c\_branch2a', 'res2c\_branch2a\_relu', 'res2c\_branch2b', 'bn2c\_branch2b', 'scale2c\_branch2b', 'res2c\_branch2b\_relu', 'res2c\_branch2c', 'bn2c\_branch2c', 'scale2c\_branch2c', 'res2c', 'res2c\_relu', 'res3a\_branch1', 'bn3a\_branch1', 'scale3a\_branch1', 'res3a\_branch2a', 'bn3a\_branch2a', 'scale3a\_branch2a', 'res3a\_branch2a\_relu', 'res3a\_branch2b', 'bn3a\_branch2b', 'scale3a\_branch2b', 'res3a\_branch2b\_relu', 'res3a\_branch2c', 'bn3a\_branch2c', 'scale3a\_branch2c', 'res3a', 'res3a\_relu', 'res3b\_branch2a', 'bn3b\_branch2a', 'scale3b\_branch2a', 'res3b\_branch2a\_relu', 'res3b\_branch2b', 'bn3b\_branch2b', 'scale3b\_branch2b', 'res3b\_branch2b\_relu', 'res3b\_branch2c', 'bn3b\_branch2c', 'scale3b\_branch2c', 'res3b', 'res3b\_relu', 'res3c\_branch2a', 'bn3c\_branch2a', 'scale3c\_branch2a', 'res3c\_branch2a\_relu', 'res3c\_branch2b', 'bn3c\_branch2b', 'scale3c\_branch2b', 'res3c\_branch2b\_relu', 'res3c\_branch2c', 'bn3c\_branch2c', 'scale3c\_branch2c', 'res3c', 'res3c\_relu', 'res3d\_branch2a', 'bn3d\_branch2a', 'scale3d\_branch2a', 'res3d\_branch2a\_relu', 'res3d\_branch2b', 'bn3d\_branch2b', 'scale3d\_branch2b', 'res3d\_branch2b\_relu', 'res3d\_branch2c', 'bn3d\_branch2c', 'scale3d\_branch2c', 'res3d', 'res3d\_relu', 'res4a\_branch1', 'bn4a\_branch1', 'scale4a\_branch1', 'res4a\_branch2a', 'bn4a\_branch2a', 'scale4a\_branch2a', 'res4a\_branch2a\_relu', 'res4a\_branch2b', 'bn4a\_branch2b', 'scale4a\_branch2b', 'res4a\_branch2b\_relu', 'res4a\_branch2c', 'bn4a\_branch2c', 'scale4a\_branch2c', 'res4a', 'res4a\_relu', 'res4b\_branch2a', 'bn4b\_branch2a', 'scale4b\_branch2a', 'res4b\_branch2a\_relu', 'res4b\_branch2b', 'bn4b\_branch2b', 'scale4b\_branch2b', 'res4b\_branch2b\_relu', 'res4b\_branch2c', 'bn4b\_branch2c', 'scale4b\_branch2c', 'res4b', 'res4b\_relu', 'res4c\_branch2a', 'bn4c\_branch2a', 'scale4c\_branch2a', 'res4c\_branch2a\_relu', 'res4c\_branch2b', 'bn4c\_branch2b', 'scale4c\_branch2b', 'res4c\_branch2b\_relu', 'res4c\_branch2c', 'bn4c\_branch2c', 'scale4c\_branch2c', 'res4c', 'res4c\_relu', 'res4d\_branch2a', 'bn4d\_branch2a', 'scale4d\_branch2a', 'res4d\_branch2a\_relu', 'res4d\_branch2b', 'bn4d\_branch2b', 'scale4d\_branch2b', 'res4d\_branch2b\_relu', 'res4d\_branch2c', 'bn4d\_branch2c', 'scale4d\_branch2c', 'res4d', 'res4d\_relu', 'res4e\_branch2a', 'bn4e\_branch2a', 'scale4e\_branch2a', 'res4e\_branch2a\_relu', 'res4e\_branch2b', 'bn4e\_branch2b', 'scale4e\_branch2b', 'res4e\_branch2b\_relu', 'res4e\_branch2c', 'bn4e\_branch2c', 'scale4e\_branch2c', 'res4e', 'res4e\_relu', 'res4f\_branch2a', 'bn4f\_branch2a', 'scale4f\_branch2a', 'res4f\_branch2a\_relu', 'res4f\_branch2b', 'bn4f\_branch2b', 'scale4f\_branch2b', 'res4f\_branch2b\_relu', 'res4f\_branch2c', 'bn4f\_branch2c', 'scale4f\_branch2c', 'res4f', 'res4f\_relu', 'res5a\_branch1', 'bn5a\_branch1', 'scale5a\_branch1', 'res5a\_branch2a', 'bn5a\_branch2a', 'scale5a\_branch2a', 'res5a\_branch2a\_relu', 'res5a\_branch2b', 'bn5a\_branch2b', 'scale5a\_branch2b', 'res5a\_branch2b\_relu', 'res5a\_branch2c', 'bn5a\_branch2c', 'scale5a\_branch2c', 'res5a', 'res5a\_relu', 'res5b\_branch2a', 'bn5b\_branch2a', 'scale5b\_branch2a', 'res5b\_branch2a\_relu', 'res5b\_branch2b', 'bn5b\_branch2b', 'scale5b\_branch2b', 'res5b\_branch2b\_relu', 'res5b\_branch2c', 'bn5b\_branch2c', 'scale5b\_branch2c', 'res5b', 'res5b\_relu', 'res5c\_branch2a', 'bn5c\_branch2a', 'scale5c\_branch2a', 'res5c\_branch2a\_relu', 'res5c\_branch2b', 'bn5c\_branch2b', 'scale5c\_branch2b', 'res5c\_branch2b\_relu', 'res5c\_branch2c', 'bn5c\_branch2c', 'scale5c\_branch2c', 'res5c', 'res5c\_relu', 'pool5', 'fc1000', 'prob']

**************************************************
* COMPUTING MEMORY REQUIREMENTS
**************************************************
Minimum Memory \_\_\_\_\_\_\_\_\_\_
17 ['res2a\_branch2c'] size:4128768.0 remap:[] data movement:[]
17	res2a\_branch2b\_blob M[0,458752] Z=458752 F=[14, 15, 16, 17] B=[13, 14, 15, 16] E=[] S=['layer'] [] L=-1
17	res2a\_branch2c\_blob M[0,1835008] Z=1835008 F=[18, 19, 20] B=[17, 18, 19] E=[] S=['layer'] [] L=-1
17	res2a\_branch1\_blob M[0,1835008] Z=1835008 F=[7, 8, 20] B=[6, 7, 8] E=[] S=['layer'] [] L=-1

**************************************************
* ALLOCATING DYNAMIC MEMORY SCHEDULE
**************************************************
Allocating Memory
Trying strategy bysize

**************************************************
* GENERATING OUTPUT REPORTS
**************************************************
Minimum Memory 46 ['res2c'] 3670016.0
res2c\_branch2c\_blob M[1835008,3670016] Z=1835008 F=[44, 45, 46] B=[43, 44, 45] E=[1] S=['layer'] [] L=1
res2c\_blob M[0,1835008] Z=1835008 F=[47, 48, 51] B=[46, 47] E=[1] S=['replace\_layer'] [] L=0

**************************************************
* GENERATING OUTPUT FILES
**************************************************
XDNN Command file: work/bvlc\_googlenet\_without\_lrn.cmd
XDNN JSON Report file: work/bvlc\_googlenet\_without\_lrn.cmd.json
OUTPUT REPORT:
Unsupported Layers: 3
0) fc1000
	Attributes: ('\#\# 261 XNInner fc1000 16 26 2 0x0 1 2048 0x20000 1000 1000', u'fc1000: type=InnerProduct, sizes=None, shapes=[[1000, 2048], [1000]], sched 227 Kernel None Strides None Padding None  NO VALID CODE  ')
1) data
	Attributes: ("\# LAYER data [u'Input'] ['layer']", u'data: type=Input, sizes=None, shapes=None, sched 0 Kernel None Strides None Padding None  NO VALID CODE  ')
2) prob
	Attributes: ("\# LAYER prob [u'Softmax'] ['layer']", u'prob: type=Softmax, sizes=None, shapes=None, sched 228 Kernel None Strides None Padding None  NO VALID CODE  ')
Compiling weights from: ../models/caffe/resnet/fp32/resnet50.caffemodel
Writing weights to directory work/resnet50.caffemodel\_data
SUCCESS

*************************************************
* GENERATING new PROTO and new caffemodel weights  
***************************************************
conv1 0: (64, 3, 7, 7) (64, 3, 7, 7)
res2a\_branch1 0: (256, 64, 1, 1) (256, 64, 1, 1)
bias shape (256,)
1: (256,) (256,)
res2a\_branch2a 0: (64, 64, 1, 1) (64, 64, 1, 1)
bias shape (64,)
1: (64,) (64,)
res2a\_branch2b 0: (64, 64, 3, 3) (64, 64, 3, 3)
bias shape (64,)
1: (64,) (64,)
res2a\_branch2c 0: (256, 64, 1, 1) (256, 64, 1, 1)
bias shape (256,)
1: (256,) (256,)
res2b\_branch2a 0: (64, 256, 1, 1) (64, 256, 1, 1)
bias shape (64,)
1: (64,) (64,)
res2b\_branch2b 0: (64, 64, 3, 3) (64, 64, 3, 3)
bias shape (64,)
1: (64,) (64,)
res2b\_branch2c 0: (256, 64, 1, 1) (256, 64, 1, 1)
bias shape (256,)
1: (256,) (256,)
res2c\_branch2a 0: (64, 256, 1, 1) (64, 256, 1, 1)
bias shape (64,)
1: (64,) (64,)
res2c\_branch2b 0: (64, 64, 3, 3) (64, 64, 3, 3)
bias shape (64,)
1: (64,) (64,)
res2c\_branch2c 0: (256, 64, 1, 1) (256, 64, 1, 1)
bias shape (256,)
1: (256,) (256,)
res3a\_branch1 0: (512, 256, 1, 1) (512, 256, 1, 1)
bias shape (512,)
1: (512,) (512,)
res3a\_branch2a 0: (128, 256, 1, 1) (128, 256, 1, 1)
bias shape (128,)
1: (128,) (128,)
res3a\_branch2b 0: (128, 128, 3, 3) (128, 128, 3, 3)
bias shape (128,)
1: (128,) (128,)
res3a\_branch2c 0: (512, 128, 1, 1) (512, 128, 1, 1)
bias shape (512,)
1: (512,) (512,)
res3b\_branch2a 0: (128, 512, 1, 1) (128, 512, 1, 1)
bias shape (128,)
1: (128,) (128,)
res3b\_branch2b 0: (128, 128, 3, 3) (128, 128, 3, 3)
bias shape (128,)
1: (128,) (128,)
res3b\_branch2c 0: (512, 128, 1, 1) (512, 128, 1, 1)
bias shape (512,)
1: (512,) (512,)
res3c\_branch2a 0: (128, 512, 1, 1) (128, 512, 1, 1)
bias shape (128,)
1: (128,) (128,)
res3c\_branch2b 0: (128, 128, 3, 3) (128, 128, 3, 3)
bias shape (128,)
1: (128,) (128,)
res3c\_branch2c 0: (512, 128, 1, 1) (512, 128, 1, 1)
bias shape (512,)
1: (512,) (512,)
res3d\_branch2a 0: (128, 512, 1, 1) (128, 512, 1, 1)
bias shape (128,)
1: (128,) (128,)
res3d\_branch2b 0: (128, 128, 3, 3) (128, 128, 3, 3)
bias shape (128,)
1: (128,) (128,)
res3d\_branch2c 0: (512, 128, 1, 1) (512, 128, 1, 1)
bias shape (512,)
1: (512,) (512,)
res4a\_branch1 0: (1024, 512, 1, 1) (1024, 512, 1, 1)
bias shape (1024,)
1: (1024,) (1024,)
res4a\_branch2a 0: (256, 512, 1, 1) (256, 512, 1, 1)
bias shape (256,)
1: (256,) (256,)
res4a\_branch2b 0: (256, 256, 3, 3) (256, 256, 3, 3)
bias shape (256,)
1: (256,) (256,)
res4a\_branch2c 0: (1024, 256, 1, 1) (1024, 256, 1, 1)
bias shape (1024,)
1: (1024,) (1024,)
res4b\_branch2a 0: (256, 1024, 1, 1) (256, 1024, 1, 1)
bias shape (256,)
1: (256,) (256,)
res4b\_branch2b 0: (256, 256, 3, 3) (256, 256, 3, 3)
bias shape (256,)
1: (256,) (256,)
res4b\_branch2c 0: (1024, 256, 1, 1) (1024, 256, 1, 1)
bias shape (1024,)
1: (1024,) (1024,)
res4c\_branch2a 0: (256, 1024, 1, 1) (256, 1024, 1, 1)
bias shape (256,)
1: (256,) (256,)
res4c\_branch2b 0: (256, 256, 3, 3) (256, 256, 3, 3)
bias shape (256,)
1: (256,) (256,)
res4c\_branch2c 0: (1024, 256, 1, 1) (1024, 256, 1, 1)
bias shape (1024,)
1: (1024,) (1024,)
res4d\_branch2a 0: (256, 1024, 1, 1) (256, 1024, 1, 1)
bias shape (256,)
1: (256,) (256,)
res4d\_branch2b 0: (256, 256, 3, 3) (256, 256, 3, 3)
bias shape (256,)
1: (256,) (256,)
res4d\_branch2c 0: (1024, 256, 1, 1) (1024, 256, 1, 1)
bias shape (1024,)
1: (1024,) (1024,)
res4e\_branch2a 0: (256, 1024, 1, 1) (256, 1024, 1, 1)
bias shape (256,)
1: (256,) (256,)
res4e\_branch2b 0: (256, 256, 3, 3) (256, 256, 3, 3)
bias shape (256,)
1: (256,) (256,)
res4e\_branch2c 0: (1024, 256, 1, 1) (1024, 256, 1, 1)
bias shape (1024,)
1: (1024,) (1024,)
res4f\_branch2a 0: (256, 1024, 1, 1) (256, 1024, 1, 1)
bias shape (256,)
1: (256,) (256,)
res4f\_branch2b 0: (256, 256, 3, 3) (256, 256, 3, 3)
bias shape (256,)
1: (256,) (256,)
res4f\_branch2c 0: (1024, 256, 1, 1) (1024, 256, 1, 1)
bias shape (1024,)
1: (1024,) (1024,)
res5a\_branch1 0: (2048, 1024, 1, 1) (2048, 1024, 1, 1)
bias shape (2048,)
1: (2048,) (2048,)
res5a\_branch2a 0: (512, 1024, 1, 1) (512, 1024, 1, 1)
bias shape (512,)
1: (512,) (512,)
res5a\_branch2b 0: (512, 512, 3, 3) (512, 512, 3, 3)
bias shape (512,)
1: (512,) (512,)
res5a\_branch2c 0: (2048, 512, 1, 1) (2048, 512, 1, 1)
bias shape (2048,)
1: (2048,) (2048,)
res5b\_branch2a 0: (512, 2048, 1, 1) (512, 2048, 1, 1)
bias shape (512,)
1: (512,) (512,)
res5b\_branch2b 0: (512, 512, 3, 3) (512, 512, 3, 3)
bias shape (512,)
1: (512,) (512,)
res5b\_branch2c 0: (2048, 512, 1, 1) (2048, 512, 1, 1)
bias shape (2048,)
1: (2048,) (2048,)
res5c\_branch2a 0: (512, 2048, 1, 1) (512, 2048, 1, 1)
bias shape (512,)
1: (512,) (512,)
res5c\_branch2b 0: (512, 512, 3, 3) (512, 512, 3, 3)
bias shape (512,)
1: (512,) (512,)
res5c\_branch2c 0: (2048, 512, 1, 1) (2048, 512, 1, 1)
bias shape (2048,)
1: (2048,) (2048,)
Compiler successfully generated JSON and the data directory: work/bvlc\_googlenet\_without\_lrn.caffemodel\_data
**********
Compilation Successful!

Network Operations Count: 7719276544
DDR Transfers (bytes): 33030144

    \end{Verbatim}

    As can be seen from the op and transfer counts, Resnet-50 takes about 2x
the number of ops (multiply + add operations) and because we gave the
compiler less on-chip memory, it now enables DDR transfers to move
certain intermediate results to and from DDR.

Well done! That concludes Part 1. Continue on to Part 2:

\subsection{\texorpdfstring{\href{quantizer_caffe.ipynb}{\textbf{Part
2:} Using the xfDNN Quantizer to Recalibrate
Models}}{Part 2: Using the xfDNN Quantizer to Recalibrate Models}}\label{part-2-using-the-xfdnn-quantizer-to-recalibrate-models}


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
